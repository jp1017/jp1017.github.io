<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[安卓那些事儿]]></title>
  <subtitle><![CDATA[思想的流浪者]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://jp1017.github.io/"/>
  <updated>2017-07-16T12:14:18.200Z</updated>
  <id>http://jp1017.github.io/</id>
  
  <author>
    <name><![CDATA[安卓开发]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[安卓开发中分析其他应用所必备的那些神器]]></title>
    <link href="http://jp1017.github.io/2017/07/08/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E4%B8%AD%E5%88%86%E6%9E%90%E5%85%B6%E4%BB%96%E5%BA%94%E7%94%A8%E6%89%80%E5%BF%85%E5%A4%87%E7%9A%84%E9%82%A3%E4%BA%9B%E7%A5%9E%E5%99%A8/"/>
    <id>http://jp1017.github.io/2017/07/08/安卓开发中分析其他应用所必备的那些神器/</id>
    <published>2017-07-08T11:26:14.000Z</published>
    <updated>2017-07-16T12:14:18.200Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://d3cbihxaqsuq0s.cloudfront.net/images/44752772_xl.jpg" alt="每日一景"></p>
<p>今天是2017年7月16日，初伏第五天，爬山游泳计划因连夜雨而取消，于是乎，加了个小班，顺便跑了个10公里，有人说你这么瘦，天这么热，你时不时傻，对此只好一笑而过，大概这就是真爱吧。比起无氧的增肌，有氧的跑步和游泳更爱一些，记得跑后拉伸哦。</p>
<p>上一篇文章写了反编译某应用获取所需代码，用到了许多神器，这篇文章就来一一铺开。。。</p>
<h2 id="apkpure"><a href="https://apkpure.com/" target="_blank" rel="external">apkpure</a></h2><p>这个是用来下载第三方应用的，无需Google play 即可下载 play 商店里的各种应用</p>
<h2 id="当前Activity">当前Activity</h2><p>该款软件可显示最前台页面所在应用的包名及Activity</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20170716195950.jpg" width="320"></p>
<a id="more"></a>
<h2 id="ActivityLauncher"><a href="https://github.com/jp1017/ActivityLauncher" target="_blank" rel="external">ActivityLauncher</a></h2><p>该款软件显示每个应用的Activity，点击Activity可直达该界面，部分因权限问题导致打开失败。在sf上开源，基于ec开发，我给移植到了 Android Studio, 大家可直接编译运行。</p>
<p><img src="https://cloud.githubusercontent.com/assets/7868514/21418385/dcb032ac-c85b-11e6-9b27-1bf03baa5696.png" width="320"></p>
<h2 id="MLManager"><a href="https://github.com/javiersantos/MLManager" target="_blank" rel="external">MLManager</a></h2><p>该款软件是一个95年的西班牙朋友写的，只要用来提取apk到本地，分享apk。国内也有一款类似的软件，和这个风格一样，咕咚大神写的<a href="https://github.com/maoruibin/AppPlus/" target="_blank" rel="external">AppPlus</a>，遗憾的国内的不支持提取系统应用，如果提取小米手机的扫一扫等系统应用就望而却步了。</p>
<p><img src="https://raw.githubusercontent.com/javiersantos/MLManager/master/Screenshots/header-basic.png" width="600"></p>
<h2 id="easydeviceinfo"><a href="https://github.com/nisrulz/easydeviceinfo/" target="_blank" rel="external">easydeviceinfo</a></h2><p>方便的获取手机的各种数据信息的库</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/Screenshot_2017-07-08-18-33-21-443_Easy%20DeviceInf.png" width="320"></p>
<h2 id="开发助手">开发助手</h2><p>滴滴大神 <a href="https://github.com/Trinea" target="_blank" rel="external">Trinea</a> 开发的一款快速调试及查看手机信息的应用</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/Screenshot_2017-07-08-18-33-42-788_%E5%BC%80%E5%8F%91%E5%8A%A9%E6%89%8B.png" width="320"></p>
<h2 id="packagehunter"><a href="https://github.com/nisrulz/packagehunter" target="_blank" rel="external">packagehunter</a></h2><p>easydeviceinfo 作者的又一神器，包猎手，快速分析一款软件所包含的各种组件</p>
<p><img src="https://github.com/nisrulz/packagehunter/raw/master/img/sc3.png" width="320"></p>
<h2 id="Native_Libs_Monitor">Native Libs Monitor</h2><p>分析一款应用内所包含的所有so库及该手机所使用的so库</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/Screenshot_2017-07-08-18-34-32-898_Native%20Libs%20Mo.png" width="320"></p>
<h2 id="安全码校验">安全码校验</h2><p>获取一款软件的SHA1签名，使用百度地图，高德地图时常因签名问题导致地图不显示，可用此查看对比。当然也可以直接用代码查看：<a href="https://github.com/Blankj/AndroidUtilCode/pull/56/files" target="_blank" rel="external">AndroidUtilCode#56</a></p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/Screenshot_2017-07-08-18-35-06-303_%E5%AE%89%E5%85%A8%E7%A0%81%E6%A0%A1%E9%AA%8C.png" width="320"></p>
<h2 id="Android_Permissions">Android Permissions</h2><p>专门查看应用权限的，上面提到的 packagehunter 也有此技能，这个显示的更友好一些</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/Screenshot_2017-07-08-18-32-40-575_Android%20Permis.png" width="320"></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://d3cbihxaqsuq0s.cloudfront.net/images/44752772_xl.jpg" alt="每日一景"></p>
<p>今天是2017年7月16日，初伏第五天，爬山游泳计划因连夜雨而取消，于是乎，加了个小班，顺便跑了个10公里，有人说你这么瘦，天这么热，你时不时傻，对此只好一笑而过，大概这就是真爱吧。比起无氧的增肌，有氧的跑步和游泳更爱一些，记得跑后拉伸哦。</p>
<p>上一篇文章写了反编译某应用获取所需代码，用到了许多神器，这篇文章就来一一铺开。。。</p>
<h2 id="apkpure"><a href="https://apkpure.com/">apkpure</a></h2><p>这个是用来下载第三方应用的，无需Google play 即可下载 play 商店里的各种应用</p>
<h2 id="当前Activity">当前Activity</h2><p>该款软件可显示最前台页面所在应用的包名及Activity</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20170716195950.jpg" width="320"/></p>]]>
    
    </summary>
    
      <category term="神器，反编译" scheme="http://jp1017.github.io/tags/%E7%A5%9E%E5%99%A8%EF%BC%8C%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[反编译某软件直接进入微信二维码扫描界面]]></title>
    <link href="http://jp1017.github.io/2017/07/07/%E5%8F%8D%E7%BC%96%E8%AF%91%E6%9F%90%E8%BD%AF%E4%BB%B6%E7%9B%B4%E6%8E%A5%E8%BF%9B%E5%85%A5%E5%BE%AE%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%89%AB%E6%8F%8F%E7%95%8C%E9%9D%A2/"/>
    <id>http://jp1017.github.io/2017/07/07/反编译某软件直接进入微信二维码扫描界面/</id>
    <published>2017-07-07T12:34:48.000Z</published>
    <updated>2017-07-07T12:37:54.609Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://d3cbihxaqsuq0s.cloudfront.net/images/37405678_xl.jpg" alt="每日一景"></p>
<p>今天无意发现了一款软件,进去点了两下,竟然直接跳到了微信二维码扫描界面,喜悦之情难以掩饰,终于等到你…</p>
<h2 id="昨夜西风凋碧树">昨夜西风凋碧树</h2><p>没错,三个月之前,我需要这个技能,网上搜索了一番,得到如下代码:</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">void</span> <span class="title">toWeChatScan</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Uri uri = Uri.parse(<span class="string">"weixin://"</span>);</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW, uri);</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然而新版本微信已经失效,只能进入到微信界面,不能打开二维码.独上高楼,望尽天涯路.</p>
<a id="more"></a>
<h2 id="衣带渐宽终不悔">衣带渐宽终不悔</h2><p>时间如流水般飞逝了两周,忽然打开了小米的扫一扫,这个软件技能真多,不仅可以扫码,还可以扫题,扫名片,扫文档,扫字翻译,这都不是重点,关键能直接进入微信和支付宝扫一扫.</p>
<p>于是提取了这个apk(怎么提取呢,后面会写个文章,专门介绍那些安卓开发神器APP,颤抖吧…).反编译了下,这个app也没混淆,也没加固,哈哈哈,最新版不知道啥情况,不过可悲的是去掉了微信和支付宝扫一扫入口…</p>
<p>反编译得到了如下代码:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">toWechatScanFromMIUI</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    String packageName = <span class="string">"com.tencent.mm"</span>;</span><br><span class="line">    String activityName = <span class="string">"com.tencent.mm.plugin.scanner.ui.BaseScanUI"</span>;</span><br><span class="line">    Intent intent;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        intent = <span class="keyword">new</span> Intent();</span><br><span class="line">        intent.setClassName(packageName, activityName);</span><br><span class="line">        intent.setFlags(<span class="number">268435456</span>);</span><br><span class="line">        intent.setComponent(<span class="keyword">new</span> ComponentName(packageName, activityName));</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个可以直接进入微信扫一扫二维码 <code>Activity</code>, 怎么知道是这个 <code>Activity</code> 呢,期待神器祭出吧.然鹅,我的APP使用这个代码,同样只打开了微信界面,并没有卵.<br>发生了什么,谷歌了一下,发现只有两种情况可以打开其他软件的 <code>Activity</code>:</p>
<ol>
<li>目标 <code>Activity</code> 有 <code>exported</code> 标签</li>
<li>需要权限 <code>android.permission.START_ANY_ACTIVITY</code></li>
</ol>
<p>发现微信扫一扫这个 <code>Activity</code> 并没有 <code>exported</code> 标签,然后在小米扫一扫的清单文件里发现了上面那个神一般的权限,然而这个权限和系统有关系,不同的系统处理有些差异,具体未测试,在miui上不好使,有了系统权限肯定好使,而这个扫一扫就具有系统权限,为伊消得人憔悴.</p>
<h2 id="众里寻他千百度">众里寻他千百度</h2><p>时间转眼就来到了七月份的前头,一切仍在他合适的轨道上运转,不偏不倚,不快不慢.</p>
<p>就像那个很火的英文诗歌写的那样：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">New York <span class="keyword">is</span> <span class="number">3</span> hours ahead <span class="keyword">of</span> California,</span><br><span class="line"><span class="keyword">but</span> <span class="keyword">it</span> <span class="keyword">does</span> <span class="keyword">not</span> make California slow.</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>诗歌写的很棒，读起来也很舒服，内容更是不用多说。</p>
<p>今天,一个普通应用打开了你,原来这就是你的样子.</p>
<ol>
<li>使用反编译神器 <code>jadx</code> 破解,还好没加固,只是混淆了一下,希望还是有的</li>
<li>用显示任意 <code>Activity</code> 的神器找到该 <code>Activity</code></li>
<li>还好代码不多,点击事件处理里跳转了一下,找到了下面的代码:</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">toWeChatScanDirect</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">        intent.setComponent(<span class="keyword">new</span> ComponentName(<span class="string">"com.tencent.mm"</span>, <span class="string">"com.tencent.mm.ui.LauncherUI"</span>));</span><br><span class="line">        intent.putExtra(<span class="string">"LauncherUI.From.Scaner.Shortcut"</span>, <span class="literal">true</span>);</span><br><span class="line">        intent.setFlags(<span class="number">335544320</span>);</span><br><span class="line">        intent.setAction(<span class="string">"android.intent.action.VIEW"</span>);</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试了下,完美展现了你的样子.蓦然回首，原来,你在这里.</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://d3cbihxaqsuq0s.cloudfront.net/images/37405678_xl.jpg" alt="每日一景"></p>
<p>今天无意发现了一款软件,进去点了两下,竟然直接跳到了微信二维码扫描界面,喜悦之情难以掩饰,终于等到你…</p>
<h2 id="昨夜西风凋碧树">昨夜西风凋碧树</h2><p>没错,三个月之前,我需要这个技能,网上搜索了一番,得到如下代码:</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">void</span> <span class="title">toWeChatScan</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Uri uri = Uri.parse(<span class="string">"weixin://"</span>);</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW, uri);</span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然而新版本微信已经失效,只能进入到微信界面,不能打开二维码.独上高楼,望尽天涯路.</p>]]>
    
    </summary>
    
      <category term="微信" scheme="http://jp1017.github.io/tags/%E5%BE%AE%E4%BF%A1/"/>
    
      <category term="扫一扫" scheme="http://jp1017.github.io/tags/%E6%89%AB%E4%B8%80%E6%89%AB/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Android Studio 使用技巧之打造优雅的 Logcat Console]]></title>
    <link href="http://jp1017.github.io/2017/03/31/Android-Studio-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B9%8B%E6%89%93%E9%80%A0%E4%BC%98%E9%9B%85%E7%9A%84-Logcat-Console/"/>
    <id>http://jp1017.github.io/2017/03/31/Android-Studio-使用技巧之打造优雅的-Logcat-Console/</id>
    <published>2017-03-31T12:37:53.000Z</published>
    <updated>2017-03-31T11:41:41.419Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://farm1.staticflickr.com/405/18579026941_707c5e524e_k.jpg" alt="来自 Momentum 的美图"></p>
<p>这篇文章主要介绍基于 <code>正则表达式</code> 屏蔽不需要的字符串, 打造更科学的日志终端.</p>
<h2 id="来源">来源</h2><p>先上一张图吧:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/746997-7e75d47b3b1ce573.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800" alt="QQ截图20170331143254.png"></p>
<a id="more"></a>
<p>从这个图可以看到, 有些日志1毫秒打印两次, 这是多么恐怖啊, 分分钟终端就满了, pageUp 按键根本跟不上节奏, 导致看不清其他日志, 那我们过滤下呗, 尴尬的是, 包名和我的 <code>APP</code> 一致, 而且 <code>Error</code> 级别, 所以选择 <code>Show only selected application</code> 根本没有效果, 屏幕唰唰而过, 没有一点点防备..</p>
<h2 id="牛刀小试">牛刀小试</h2><blockquote>
<p>不想看到, 就把他拉黑啊</p>
</blockquote>
<p>没错, 简单直接, 粗暴高效.</p>
<p>直接在过滤器里面拉黑他, 用正则拉黑, 看起来是这样子:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/746997-3c01b19ca5587676.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20170331185934.png"></p>
<p>然而并没有什么卵用, 屏幕刷刷刷依旧. 就差一个千里眼了…</p>
<p>关于 <code>正则表达式</code>, 可以看看这篇文章:</p>
<p><a href="http://embeddedlinux.org.cn/emb-linux/entry-level/201703/30-6355.html#" target="_blank" rel="external">Linux基础之-正则表达式（grep，sed，awk）</a></p>
<p>之前是排斥 <code>正则表达式</code> 的, 后来发现威力无穷, 于是乎, 以后要好好使用咯.</p>
<h2 id="正式拉黑">正式拉黑</h2><p>于是, google 了一下, 提醒各位, 用 google 最好输入 英文关键字, 这样你会 <code>得到</code> 你想要的.</p>
<p>操作很简单:<br>1: 点击右侧下拉窗, 选择 <code>Edit Filter Configuration</code>, 打开过滤器配置窗口<br>2: 配置下这个窗口, 如下:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/746997-0a5e754bc1373b71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20170331191455.png"></p>
<p>图片里写的还算详细, 包含了基本用途, 相信你看过会打造自己的过滤器, 这样配置后, 终端瞬间清爽很多. </p>
<h3 id="参考文章:">参考文章:</h3><p><a href="https://stackoverflow.com/questions/5511433/how-to-exclude-certain-messages-by-tag-name-using-android-adb-logcat" target="_blank" rel="external">https://stackoverflow.com/questions/5511433/how-to-exclude-certain-messages-by-tag-name-using-android-adb-logcat</a></p>
<p>如何让 Logcat 更美观, 请点击这里:</p>
<p><a href="http://www.jianshu.com/p/5361ac0584a0" target="_blank" rel="external">Android Studio美化之优雅的logcat</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>欢迎加入安卓开发QQ群: 484167109 </p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://farm1.staticflickr.com/405/18579026941_707c5e524e_k.jpg" alt="来自 Momentum 的美图"></p>
<p>这篇文章主要介绍基于 <code>正则表达式</code> 屏蔽不需要的字符串, 打造更科学的日志终端.</p>
<h2 id="来源">来源</h2><p>先上一张图吧:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/746997-7e75d47b3b1ce573.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800" alt="QQ截图20170331143254.png"></p>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/tags/Android-Studio/"/>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/categories/Android-Studio/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[加速 gradle 编译之屏蔽部分 Task]]></title>
    <link href="http://jp1017.github.io/2017/03/08/%E5%8A%A0%E9%80%9F-gradle-%E7%BC%96%E8%AF%91%E4%B9%8B%E5%B1%8F%E8%94%BD%E9%83%A8%E5%88%86-Task/"/>
    <id>http://jp1017.github.io/2017/03/08/加速-gradle-编译之屏蔽部分-Task/</id>
    <published>2017-03-08T12:37:53.000Z</published>
    <updated>2017-03-08T12:45:36.011Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/152670813/m%3D2048/74a0afd72b362155a4149bcf691942e2" alt="每日一景"></p>
<h2 id="灵感来源">灵感来源</h2><p>该篇博客灵感来自之前的一片博客:</p>
<p><a href="http://www.jianshu.com/p/1870d4a655bf" target="_blank" rel="external">Android Studio clean 时产生 Error:Execution failed for task ‘:app:mockableAndroidJar’ &gt; java.lang.NullPointerException (no error message)</a></p>
<p>和一个神库的issue:</p>
<p><a href="https://github.com/anggrayudi/android-hidden-api/issues/21" target="_blank" rel="external">android-hidden-api#21</a></p>
<a id="more"></a>
<h3 id="首先简单介绍下这个神库——android-hidden-api:_可以让你使用安卓系统中_internal/hidden_的方法。">首先简单介绍下这个神库——<code>android-hidden-api</code>: 可以让你使用安卓系统中　<code>internal/hidden</code>　的方法。</h3><p>比如, <code>Activity</code>　里有一个@hide的方法:</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * <span class="doctag">@hide</span></span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="function"><span class="keyword">boolean</span> <span class="title">isResumed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mResumed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>没用该库之前引用这个方法会报找不到该方法:</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/25/43d194cf00bcfd5f201f82fe684add07.png" alt="isResumed"></p>
<p>但是使用该库后, 编译正常:</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/25/ff49c6e6023e3fad0d4879d6eb07d095.png" alt="isResumed internal"></p>
<p>编译通过了, 实际运行怎么样呢, 该方法可运行正常, 但是不保证所有系统, 同时也不能保证所有内部方法可运行。裤子不错, 不要贪用哦, 要多测试, 并加入异常处理。</p>
<p>详细使用可参考鸿神之前的文章:</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650820284&amp;idx=1&amp;sn=43cbc5cbbf7d67ca3c5d8dc05f6fd4d0#rd" target="_blank" rel="external">Android 轻松的查看与使用hide与internal API</a></p>
<h2 id="加速gradle编译">加速gradle编译</h2><p>1 常用的加速方法, 大家可能都配置好了, 主要下面几个:</p>
<ul>
<li>开启gradle单独的守护进程<br>在gradle.properties文件中输入如下代码：</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org<span class="class">.gradle</span><span class="class">.daemon</span>=true</span><br><span class="line">org<span class="class">.gradle</span><span class="class">.jvmargs</span>=-Xmx2048m -XX:MaxPermSize=<span class="number">512</span>m -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-<span class="number">8</span></span><br><span class="line">org<span class="class">.gradle</span><span class="class">.parallel</span>=true</span><br><span class="line">org<span class="class">.gradle</span><span class="class">.configureondemand</span>=true</span><br></pre></td></tr></table></figure>
<p>当然，上面的这些参数也可以配置到前面的用户目录下的gradle.properties文件里，那样就不是针对一个项目生效，而是针对所有项目生效。<br>gradle.properties配置文件主要就是增大gradle运行的java虚拟机的大小，让gradle在编译的时候使用独立进程，让gradle可以平行的运行。</p>
<ul>
<li>申请大内存</li>
</ul>
<p>as安装目录/bin/studio64.vmoptions or studio.vmoptions(linux下，其他系统找类似文件)<br>使用文本编辑器打开，找到起始两行，如下<br>-Xms128m<br>-Xmx750m</p>
<p>修改最小值和最大值，建议为<br>-Xms256m<br>-Xmx2048m</p>
<ul>
<li>incremental dex<br>改变incremental dexing的值，这是一个实验的功能并且默认是关闭的。打开这个开关有可能会导致构建失败，错误信息类似jdk finished with non-zero exit value 2<br>（尤其是在连续运行的时候），但我还是推荐你尝试一下，看看它是否对你有用。</li>
</ul>
<p>在主APP模块的build.gradle文件中，添加下面的代码：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">dexOptions</span> &#123;</span><br><span class="line">    <span class="title">incremental</span> <span class="built_in">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2 屏蔽部分Task</p>
<p>我们知道, 编译的时候, 是有很多Task运行的, 可在右侧 <code>gradle</code> 标签下看到:</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/25/9a726f809754bf8b59fe84fd42ae70a8.png" alt="gradle tasks"></p>
<p>当我们正常编译的时候, 这些Task都是会运行的, 我们看下编译log:</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/25/f25873c742e0a22b428d9f9dfbd72019.png" alt="gradle uptodate"></p>
<p>很多Task后面都有 <code>UP-TO-DATE</code>也就是Task已是最新, 这些基本不耗时, 其他都耗时, 项目大, 同时依赖多个库, 那么慢是正常的了…</p>
<p>so,</p>
<p>屏蔽不需要的Task, 比如一些测试Task, 中间含有<code>Test</code>的一些Task, 把这些屏蔽掉:</p>
<p>在项目的根build.gradle脚本里添加屏蔽Task的代码:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">allprojects</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//skip Test tasks</span></span><br><span class="line">    gradle.taskGraph.whenReady &#123;</span><br><span class="line">        tasks.<span class="keyword">each</span> &#123; <span class="keyword">task</span> -&gt;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">task</span>.name.contains(<span class="string">"Test"</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">task</span>.enabled = <span class="keyword">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样sync, 编译, 见证奇迹的时刻:</p>
<p><img src="https://user-gold-cdn.xitu.io/2016/12/25/a56c173e3d02667597d768a46137c12a.png" alt="task skipped"></p>
<p>Oh, 圣诞快乐 :smile: 没错, 好多Task后面被标记了<code>SKIPPED</code>, 那这些Task都被无情的忽视了, 酸爽。</p>
<p>其他可屏蔽Task欢迎交流, 编译时间的提升效果还是很明显的, 项目越大越明显。</p>
<p>其他可屏蔽 Task 可以参考这里: <a href="https://mp.weixin.qq.com/s?__biz=MzI0NDYzMzg0OQ==&amp;mid=2247483974&amp;idx=1&amp;sn=c88299b9c458521db9e7ba4863f90d52&amp;chksm=e95b9bd0de2c12c6f8270a4fcc8185ec2dbef320410a0e11c81bea965166c9802d10e6247d68&amp;mpshare=1&amp;scene=1&amp;srcid=0217eAem4indDR0UYuyTXO99#rd" target="_blank" rel="external">编译时间从33.8秒降到4.5秒我只多做了一件事</a></p>
<p>到这里就差不多了, 当然, 网上还有很多加速编译的方法, 最好用的还是阿里的</p>
<p><a href="https://github.com/alibaba/freeline" target="_blank" rel="external">秒级编译工具freeline</a></p>
<p>这个还没使用的, 赶紧用起来, 赶紧用起来, 赶紧用起来, 不解释。</p>
<p>到这里该说再见了, 有任何问题欢迎评论, 感谢您的阅读, 圣诞快乐！</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/152670813/m%3D2048/74a0afd72b362155a4149bcf691942e2" alt="每日一景"></p>
<h2 id="灵感来源">灵感来源</h2><p>该篇博客灵感来自之前的一片博客:</p>
<p><a href="http://www.jianshu.com/p/1870d4a655bf">Android Studio clean 时产生 Error:Execution failed for task ‘:app:mockableAndroidJar’ &gt; java.lang.NullPointerException (no error message)</a></p>
<p>和一个神库的issue:</p>
<p><a href="https://github.com/anggrayudi/android-hidden-api/issues/21">android-hidden-api#21</a></p>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/tags/Android-Studio/"/>
    
      <category term="gradle" scheme="http://jp1017.github.io/tags/gradle/"/>
    
      <category term="gradle" scheme="http://jp1017.github.io/categories/gradle/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[微信热修复tinker及tinker server快速接入]]></title>
    <link href="http://jp1017.github.io/2016/11/25/%E5%BE%AE%E4%BF%A1%E7%83%AD%E4%BF%AE%E5%A4%8Dtinker%E5%8F%8Atinker-server%E5%BF%AB%E9%80%9F%E6%8E%A5%E5%85%A5/"/>
    <id>http://jp1017.github.io/2016/11/25/微信热修复tinker及tinker-server快速接入/</id>
    <published>2016-11-25T11:44:08.000Z</published>
    <updated>2016-11-25T12:00:33.756Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://images.unsplash.com/photo-1479030160180-b1860951d696?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;s=58049462f876ab4785ae452fcce306ce" alt="来自unsplash的美图"></p>
<p>当前热修复方案很多，今天研究了下微信的tinker，使用效果还是不错的，配合tinker server服用更佳。下面介绍两者的使用，以便大家快速接入。</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-11-25-16-23-56-729_tinker.sample..png" width="320"> <img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-11-25-18-57-32-149_tinker.sample..png" width="320"></p>
<h1 id="tinker_接入指南">tinker 接入指南</h1><h2 id="安装tinker_gradle插件">安装tinker gradle插件</h2><p>1 在项目的build.gradle中, 添加tinker-patch-gradle-plugin的依赖</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> (<span class="string">'com.tencent.tinker:tinker-patch-gradle-plugin:1.7.5'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>2 然后在app的gradle文件app/build.gradle，我们需要添加tinker的库依赖以及apply tinker的gradle插件.</p>
<p>//apply tinker插件</p>
<blockquote>
<p>apply plugin: ‘com.tencent.tinker.patch’</p>
</blockquote>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="comment">//可选，用于生成application类</span></span><br><span class="line">    provided(<span class="string">'com.tencent.tinker:tinker-android-anno:1.7.5'</span>)</span><br><span class="line">    <span class="comment">//tinker的核心库</span></span><br><span class="line">    <span class="keyword">compile</span>(<span class="string">'com.tencent.tinker:tinker-android-lib:1.7.5'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="配置tinker_task">配置tinker task</h2><p>配置基础包, tinkerid, dexMode等，详见gradle配置: <a href="https://github.com/jp1017/tinker-sample-android/blob/master/app/build.gradle" target="_blank" rel="external">tinker task 配置</a></p>
<p>我做了如下修改:</p>
<p>1 修改tinkerid为版本号, 跳过了需要commit一次的坑:smile:<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getTinkerIdValue</span></span>() &#123;</span><br><span class="line">    <span class="regexp">//</span>版本作为id</span><br><span class="line">    <span class="keyword">return</span> android.defaultConfig.versionName</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2 移动备份文件到/tinker/bakApk/下, 防止clean掉基础包文件</p>
<p>3 重命名备份文件, 比如<code>base-app-debug-v1.0.1-2016-1125.apk</code>, 当然自动生成的是<code>app-debug-v1.0.1-2016-1125.apk</code>, 需要手动添加前缀作为基础包, 后面多次编译不会把基础包覆盖掉, 也不会像官方demo里那样以秒命名产生很多文件…</p>
<p>4 修改tinker message 为 <code>I am the patch apk-v版本号</code></p>
<p>5 修改patchVersion为版本号, 这个在tinker server需要</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="function"><span class="title">configField</span><span class="params">(<span class="string">"patchVersion"</span>, <span class="string">"1.0.7"</span>)</span></span></span><br><span class="line">+<span class="function"><span class="title">configField</span><span class="params">(<span class="string">"patchVersion"</span>, android.defaultConfig.versionName)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong> 里面有些修改的地方, 包名修改为你的包名等, 我用todo做了标记</p>
<h2 id="生成_Application">生成 Application</h2><p>如果你有Application类, 那么需要自定义一个DefaultApplicationLike, 让tinker帮你生成Application</p>
<p>正如项目里的<code>public class SampleApplicationLike extends DefaultApplicationLike {</code></p>
<p>并对类添加注解, 比如添加如下注解:</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@DefaultLifeCycle</span>(</span><br><span class="line">application = <span class="string">"tinker.sample.android.app.SampleApplication"</span>,             <span class="comment">//application name to generate</span></span><br><span class="line">flags = ShareConstants.TINKER_ENABLE_ALL)</span><br></pre></td></tr></table></figure>
<p>编译后, 会生成一个SampleApplication, 用这个作为你的Application, 写入清单文件</p>
<p>好了, tinker到这里就配置好了, 下面开始打补丁</p>
<h2 id="打补丁包">打补丁包</h2><p>1 命令行</p>
<p>打debug补丁: <code>./gradlew tinkerPatchDebug</code></p>
<p>打release补丁: <code>./gradlew tinkerReleaseDebug</code></p>
<p>这里需要注意, 命令在linux和mac下最好是<code>./gradlew</code>, 意思是当前项目的gradlew, 如果写成<code>gradlew</code>可以会去下载gradle等, 因为那是全局的, 比如AS2.2.2带的版本是2.14.1<br>而我现在的是最新版本3.2.1, 可输入<code>./gradlew -v</code> 和 <code>gradlew -v</code>　查看<br>而windows就可以是<code>gradlew</code></p>
<p><strong>注意</strong> debug和release配置的基包不同, 和他们一一对应, 另外, release还需要配置mapping文件.</p>
<p>2 双击对应task</p>
<p>就是去gradle projects里找到对应task, 双击执行就可以, 如下图:</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20161125%20125123tinker%20gradle.png" alt="gradle"></p>
<p>比如, 打debug补丁, 双击<code>tinkerPatchDebug</code>就可以了</p>
<p>下一次打补丁时就可以从快捷栏选择，然后点击右侧运行, 如下图:</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20161125130855tinker1.png" alt="patch"></p>
<h2 id="安装及卸载补丁">安装及卸载补丁</h2><h3 id="加载补丁">加载补丁</h3><p>第二个参数是补丁包存放路径, 名称任意, 可以不以 <code>.bak</code> 结尾</p>
<blockquote>
<p>TinkerInstaller.onReceiveUpgradePatch(getApplicationContext(), patchPath);</p>
</blockquote>
<p>还可以自定义加载成功等交互, 请参考 <code>SampleResultService</code>, 别忘记添加进清单</p>
<h3 id="清除补丁">清除补丁</h3><p>当补丁出现异常或者某些情况，我们可能希望清空全部补丁，调用方法为：</p>
<blockquote>
<p>Tinker.with(context).cleanPatch();</p>
</blockquote>
<p>当然我们也可以选择卸载某个版本的补丁文件：</p>
<blockquote>
<p>Tinker.with(context).cleanPatchByVersion();</p>
</blockquote>
<p>在升级版本时我们也无须手动去清除补丁，框架已经为我们做了这件事情。需要注意的是，在补丁已经加载的前提下清除补丁，可能会引起crash。这个时候更好重启一下所有的进程。</p>
<h3 id="查看补丁是否加载">查看补丁是否加载</h3><blockquote>
<p>boolean isPatched = tinker.isTinkerLoaded();</p>
</blockquote>
<h1 id="tinker_server_接入及使用">tinker server　接入及使用</h1><p>tinker server　提供tinker补丁包下发及监控等, 使用也是很简单</p>
<h2 id="gradle_配置环境">gradle 配置环境</h2><p>1 gradle远程仓库依赖jcenter</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">repositories</span> &#123;</span><br><span class="line">    jcenter()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2 再添加sdk库的dependencies依赖:<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="keyword">compile</span>(<span class="string">"com.tencent.tinker:tinker-server-android:0.3.0"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3 在 TinkerPatch 平台中得到的 AppKey 以及 AppVersion，将他们写入 buildConfig 中:</p>
<p>比如:</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">buildConfigField <span class="string">"String"</span>, <span class="string">"APP_KEY"</span>, <span class="string">"\"</span>f938475486f91936\<span class="string">""</span></span><br><span class="line">buildConfigField <span class="string">"String"</span>, <span class="string">"APP_VERSION"</span>,  <span class="string">"\"</span><span class="number">3.0</span>.<span class="number">0</span>\<span class="string">""</span></span><br></pre></td></tr></table></figure>
<p>平台链接: <a href="http://tinkerpatch.com/" target="_blank" rel="external">tinkerpatch.com</a></p>
<p>新增app后可以得到AppKey, 至于AppVersion, 就是补丁的版本, 我这里都是版本号, 可以参考这个issue: <a href="https://github.com/simpleton/tinker_server_client/issues/2" target="_blank" rel="external">关于AppVersion问题</a></p>
<p>4 清单配置网络及sd卡读写权限</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:<span class="property">name</span>=<span class="string">"android.permission.READ_EXTERNAL_STORAGE"</span>/&gt;</span><br><span class="line">&lt;uses-permission android:<span class="property">name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span><br><span class="line">&lt;uses-permission android:<span class="property">name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="代码初始化">代码初始化</h2><blockquote>
<p>TinkerServerManager.installTinkerServer(getApplication(), Tinker.with(getApplication()), 3);</p>
</blockquote>
<p>后面的3表示每隔3小时请求一次服务器, 检查是否有更新包</p>
<h2 id="请求更新补丁">请求更新补丁</h2><p>1 主动请求更新</p>
<blockquote>
<p>TinkerServerManager.checkTinkerUpdate(true);</p>
</blockquote>
<p>2 获取新增参数</p>
<blockquote>
<p>TinkerServerManager.getDynamicConfig(new ConfigRequestCallback() {…</p>
</blockquote>
<p>下面来一个该demo的tinker server 截图:</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20161125183501tinker_server.png" alt="tinker_server"></p>
<h1 id="参考">参考</h1><p>更多使用及问题请参考官方文档:</p>
<p><a href="https://github.com/Tencent/tinker/wiki" target="_blank" rel="external">Tinker – 微信Android热补丁方案</a></p>
<p><a href="https://github.com/Tencent/tinker/wiki/Tinker-%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97" target="_blank" rel="external">Tinker 接入指南</a></p>
<p><a href="https://github.com/Tencent/tinker/wiki/Tinker-API%E6%A6%82%E8%A7%88" target="_blank" rel="external">Tinker API概览</a></p>
<p><a href="https://github.com/Tencent/tinker/wiki/Tinker-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%89%A9%E5%B1%95" target="_blank" rel="external">Tinker 自定义扩展</a></p>
<p><a href="https://github.com/Tencent/tinker/wiki/Tinker-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" target="_blank" rel="external">Tinker 常见问题</a></p>
<p><a href="http://tinkerpatch.com/Docs/api" target="_blank" rel="external">Tinker Platform 平台使用文档</a></p>
<p>代码就是Tinker官方示例，我做了一些修改，可点击这里查看: <a href="https://github.com/jp1017/tinker-sample-android" target="_blank" rel="external">https://github.com/jp1017/tinker-sample-android</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://images.unsplash.com/photo-1479030160180-b1860951d696?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;s=58049462f876ab4785ae452fcce306ce" alt="来自unsplash的美图"></p>
<p>当前热修复方案很多，今天研究了下微信的tinker，使用效果还是不错的，配合tinker server服用更佳。下面介绍两者的使用，以便大家快速接入。</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-11-25-16-23-56-729_tinker.sample..png" width="320"/> <img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-11-25-18-57-32-149_tinker.sample..png" width="320"/></p>
<h1 id="tinker_接入指南">tinker 接入指南</h1><h2 id="安装tinker_gradle插件">安装tinker gradle插件</h2><p>1 在项目的build.gradle中, 添加tinker-patch-gradle-plugin的依赖</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> (<span class="string">'com.tencent.tinker:tinker-patch-gradle-plugin:1.7.5'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="tinker" scheme="http://jp1017.github.io/tags/tinker/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[安卓数据库 greenDAO3 使用之二数据库升级]]></title>
    <link href="http://jp1017.github.io/2016/10/11/%E5%AE%89%E5%8D%93%E6%95%B0%E6%8D%AE%E5%BA%93-greenDAO3-%E4%BD%BF%E7%94%A8%E4%B9%8B%E4%BA%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8D%87%E7%BA%A7/"/>
    <id>http://jp1017.github.io/2016/10/11/安卓数据库-greenDAO3-使用之二数据库升级/</id>
    <published>2016-10-11T06:00:46.000Z</published>
    <updated>2016-10-14T12:45:35.814Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/99564077/m%3D2048/10c2a2c4b75b9fd4e018ea9e1c5cf50a" alt="每日一景"></p>
<p><a href="https://travis-ci.org/jp1017/GreenDAO3_Demo" target="_blank" rel="external"><img src="https://travis-ci.org/jp1017/GreenDAO3_Demo.svg?branch=master" alt="Build Status"></a></p>
<h2 id="数据库升级">数据库升级</h2><hr>
<p>前面，我们学会了greenDAO的使用，下面来学习下升级。</p>
<p>今天研究了下升级，掌握方法了还是蛮简单的，这里对数据库的升级，仅仅是添加字段，添加表。对于删除，修改字段这里不多讲，因为sqlite数据库不适合此操作：</p>
<blockquote>
<p>SQLite supports a limited subset of ALTER TABLE. The ALTER TABLE command in SQLite allows the user to rename a table or to add a new column to an existing table. It is not possible to rename a column, remove a column, or add or remove constraints from a table.</p>
</blockquote>
<a id="more"></a>
<p>简单讲就是 SQlite 数据库仅能重命名表及增加字段，其他不支持，如果您一定要操作，也是可以的，来这里吧：</p>
<p><a href="http://www.2cto.com/database/201110/106835.html" target="_blank" rel="external">SQLite如何删除，修改、重命名列</a></p>
<h3 id="1_升级版本号">1 升级版本号</h3><hr>
<p>上面我们说到，在 gradle 里修改 schemaVersion 即可，现在我们设置为2，编译下，我们可以看到 DaoMaster 里的schema变为2：</p>
<blockquote>
<p>public static final int SCHEMA_VERSION = 2;</p>
</blockquote>
<h3 id="2_实体添加字段">2 实体添加字段</h3><hr>
<p>比如我们的 Student 添加一个 score 字段， 这个可以直接写到 Student 里：</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">String</span> score;</span><br></pre></td></tr></table></figure>
<p>编译后即可生成完整的 Student 实体及 DAO</p>
<h3 id="3重写onUpgrade方法升级">3重写onUpgrade方法升级</h3><hr>
<p>这个就是重写 MyOpenHelper 的 onUpgrade 方法，该方法只在 schema 升级时执行一次.</p>
<p>在该方法里添加 score 字段即可</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onUpgrade</span><span class="params">(Database db, <span class="keyword">int</span> oldVersion, <span class="keyword">int</span> newVersion)</span> </span>&#123;</span><br><span class="line">    KLog.w(<span class="string">"db version update from "</span> + oldVersion + <span class="string">" to "</span> + newVersion);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (oldVersion) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            //不能先删除表，否则数据都木了</span><br><span class="line">//                StudentDao.dropTable(db, <span class="keyword">true</span>);</span><br><span class="line">            StudentDao.createTable(db, <span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">// 加入新字段 score</span></span><br><span class="line">            db.execSQL(<span class="string">"ALTER TABLE 'STUDENT' ADD 'SCORE' TEXT;"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4_测试">4 测试</h3><hr>
<p>运行代码后，再添加三个数据，我们看下界面及数据库内容：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-10-11-16-15-21-621_com.inst.green.png" width="320"> <img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-10-11-16-15-31-503_com.speedsoftw.png" width="320"></p>
<p>代码已上传至 GitHub：<a href="https://github.com/jp1017/GreenDAO3_Demo/tree/update" target="_blank" rel="external">GreenDAO3_Demo</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/99564077/m%3D2048/10c2a2c4b75b9fd4e018ea9e1c5cf50a" alt="每日一景"></p>
<p><a href="https://travis-ci.org/jp1017/GreenDAO3_Demo"><img src="https://travis-ci.org/jp1017/GreenDAO3_Demo.svg?branch=master" alt="Build Status"></a></p>
<h2 id="数据库升级">数据库升级</h2><hr>
<p>前面，我们学会了greenDAO的使用，下面来学习下升级。</p>
<p>今天研究了下升级，掌握方法了还是蛮简单的，这里对数据库的升级，仅仅是添加字段，添加表。对于删除，修改字段这里不多讲，因为sqlite数据库不适合此操作：</p>
<blockquote>
<p>SQLite supports a limited subset of ALTER TABLE. The ALTER TABLE command in SQLite allows the user to rename a table or to add a new column to an existing table. It is not possible to rename a column, remove a column, or add or remove constraints from a table.</p>
</blockquote>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="greenDAO" scheme="http://jp1017.github.io/tags/greenDAO/"/>
    
      <category term="数据库" scheme="http://jp1017.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[安卓数据库 greenDAO3 使用之一项目配置及增删改查]]></title>
    <link href="http://jp1017.github.io/2016/10/11/%E5%AE%89%E5%8D%93%E6%95%B0%E6%8D%AE%E5%BA%93-greenDAO3-%E4%BD%BF%E7%94%A8%E4%B9%8B%E4%B8%80%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE%E5%8F%8A%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"/>
    <id>http://jp1017.github.io/2016/10/11/安卓数据库-greenDAO3-使用之一项目配置及增删改查/</id>
    <published>2016-10-11T06:00:11.000Z</published>
    <updated>2016-11-04T05:24:29.011Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/123084989/m%3D2048/3cf62f6ffbb8163c1c192f28fb50da24" alt="每日一景"></p>
<p><a href="https://travis-ci.org/jp1017/GreenDAO3_Demo" target="_blank" rel="external"><img src="https://travis-ci.org/jp1017/GreenDAO3_Demo.svg?branch=master" alt="Build Status"></a></p>
<h2 id="配置">配置</h2><hr>
<p><strong>喜讯</strong>：现在greenDAO升级到了3.0版本，不需要java项目了</p>
<p>强烈建议升级到3.0版本，该版本采用注解的方式通过编译生成Java数据对象和DAO对象，配置更简单</p>
<p>之前2.0版本的配置也写过，参考这里：<a href="https://jp1017.github.io/2015/12/20/Android-SQLite-ORM%E6%A1%86%E6%9E%B6greenDAO%E5%9C%A8Android-Studio%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8/">Android SQLite ORM框架greenDAO在Android Studio中的配置与使用</a></p>
<a id="more"></a>
<h3 id="1_添加依赖">1 添加依赖</h3><hr>
<p>项目的gradle脚本：</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.android.tools.build:gradle:2.2.1'</span></span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'org.greenrobot:greendao-gradle-plugin:3.1.0'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>module的gradle：</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: <span class="string">'com.android.application'</span></span><br><span class="line">apply plugin: <span class="string">'org.greenrobot.greendao'</span></span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">24</span></span><br><span class="line">    buildToolsVersion <span class="string">"24.0.3"</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId <span class="string">"com.inst.greendao3_demo"</span></span><br><span class="line">        minSdkVersion <span class="number">14</span></span><br><span class="line">        targetSdkVersion <span class="number">24</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">"1.0"</span></span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//greendao配置</span></span><br><span class="line">greendao &#123;</span><br><span class="line">    schemaVersion <span class="number">1</span>                             <span class="comment">//版本号，升级时可配置</span></span><br><span class="line">    daoPackage<span class="string">'com.inst.greendao3_demo.dao'</span>     <span class="comment">//包名</span></span><br><span class="line">    targetGenDir<span class="string">'src/main/java'</span>                 <span class="comment">//生成目录</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="keyword">compile</span> <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>])</span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'org.greenrobot:greendao:3.1.1'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，3.0多了个greendao插件，直接在这里配置实体及DAO生成目录，我的配置是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">greendao &#123;</span><br><span class="line">    schemaVersion <span class="number">1</span>                             //版本号，升级时可配置</span><br><span class="line">    daoPackage<span class="string">'com.inst.greendao3_demo.dao'</span>     //包名</span><br><span class="line">    targetGenDi<span class="string">r'src/main/java'</span>                 //生成目录</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这三个字段的意思是：</p>
<blockquote>
<p>schemaVersion： 数据库schema版本，可在这里升级数据库版本<br> daoPackage：设置DaoMaster、DaoSession、Dao包名<br> targetGenDir：设置DaoMaster、DaoSession、Dao目录</p>
</blockquote>
<p>配置好后，同步下，然后编译，就会生成 Dao。</p>
<h3 id="2_添加实体类">2 添加实体类</h3><hr>
<p>我这里的是Student实体类，和普通的bean有个区别，添加 <code>@Entity</code> 注解</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Student &#123;</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    <span class="keyword">public</span> Long id;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">String</span> name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">String</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">String</span> <span class="built_in">number</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">String</span> score;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意到，变量 <code>id</code> 添加了 @Id 注解，这个就是主键了</p>
<p><strong>注意: </strong> id 的类型是 <code>Long</code>， 不要写成 <code>long</code>，否则会出现主键不能相同等异常</p>
<h3 id="生成DAO">生成DAO</h3><hr>
<p>上面配置好后，同步，编译，即可自动生成DAO, 并自动补全实体类 Student 的getter setter 等方法。</p>
<h2 id="增删改查">增删改查</h2><hr>
<p>上面的操作就完成了数据库的创建，下面开始对数据库操作，常用的增删改查。</p>
<p>这里对基本操作封装下，参考这里：<a href="http://blog.inet198.cn/?sbsujjbcy/article/details/48156683" target="_blank" rel="external">Android ORM系列之GreenDao最佳实践</a></p>
<p>1 编写一个核心辅助类DbCore, 用于获取DaoMaster和DaoSession</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function">DaoMaster <span class="title">getDaoMaster</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (daoMaster == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//此处不可用 DaoMaster.DevOpenHelper, 那是开发辅助类，我们要自定义一个，方便升级</span></span><br><span class="line">        DaoMaster.OpenHelper helper = <span class="keyword">new</span> MyOpenHelper(mContext, DB_NAME);</span><br><span class="line">        daoMaster = <span class="keyword">new</span> DaoMaster(helper.getWritableDatabase());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> daoMaster;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里需要注意的是 getDaoMaster 时的 helper 不可用 DaoMaster.DevOpenHelper，我们需要自定义一个：</p>
<p>因为该类这样提示我们：</p>
<blockquote>
<p>/<em>* WARNING: Drops all table on Upgrade! Use only during development. </em>/<br>     public static class DevOpenHelper extends OpenHelper</p>
</blockquote>
<p>也就是开发中使用的助手，自定义也很简单：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">MyOpenHelper</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">DaoMaster</span>.<span class="title">OpenHelper</span> &#123;</span></span><br><span class="line">    public <span class="type">MyOpenHelper</span>(<span class="type">Context</span> context, <span class="type">String</span> name) &#123;</span><br><span class="line">        <span class="keyword">super</span>(context, name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2 基础的泛型 BaseDbHelper, 封装基本增删改查方法，具体看代码吧</p>
<p>3 实现类，有几个实体类就有几个实现类，这里是 StudentHelper, 仅仅一个构造方法即可</p>
<p>4 一个工具类 DbUtils 获得 Helper</p>
<p>5 在 application 里初始化</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">DaoApplication</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">Application</span> &#123;</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//初始化数据库</span></span><br><span class="line">        <span class="type">DbCore</span>.init(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>6 测试</p>
<p>方法就很简单了，获取 helper， 然后 <code>add</code> <code>remove</code> <code>update</code> <code>query</code></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">StudentHelper mHelper = DbUtil.getDriverHelper();</span><br><span class="line"><span class="comment">//增加一个数据</span></span><br><span class="line">mFastAdapter.add(stu);</span><br><span class="line"><span class="comment">//删除一个数据</span></span><br><span class="line">mFastAdapter.remove(stu);</span><br><span class="line"><span class="comment">//更新一个数据</span></span><br><span class="line">mFastAdapter.<span class="keyword">update</span>(stu);</span><br><span class="line"><span class="comment">//查找所有数据</span></span><br><span class="line">mFastAdapter.queryAll();</span><br><span class="line"><span class="comment">//查找数据库中age大于20的数据</span></span><br><span class="line"><span class="keyword">Query</span>&lt;Student&gt; <span class="keyword">query</span> = mHelper.queryBuilder()</span><br><span class="line">    .where(StudentDao.Properties.Age.<span class="keyword">ge</span>(<span class="string">"20"</span>))</span><br><span class="line">    .build();</span><br><span class="line">dbStudents = <span class="keyword">query</span>.<span class="keyword">list</span>();</span><br></pre></td></tr></table></figure>
<p>运行程序，添加几个数据，我们看下界面及数据库内容：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-10-11-16-06-13-526_com.inst.green.png" width="320"> <img src="http://7xlah4.com1.z0.glb.clouddn.com/2016-10-11-16-06-26-262_com.speedsoftw.png" width="320"></p>
<h2 id="升级">升级</h2><hr>
<p>请参考下一篇文章：<a href="">安卓数据库 greenDAO3 使用之二数据库升级</a></p>
<p>代码已上传至 GitHub：<a href="https://github.com/jp1017/GreenDAO3_Demo/tree/update" target="_blank" rel="external">GreenDAO3_Demo</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/123084989/m%3D2048/3cf62f6ffbb8163c1c192f28fb50da24" alt="每日一景"></p>
<p><a href="https://travis-ci.org/jp1017/GreenDAO3_Demo"><img src="https://travis-ci.org/jp1017/GreenDAO3_Demo.svg?branch=master" alt="Build Status"></a></p>
<h2 id="配置">配置</h2><hr>
<p><strong>喜讯</strong>：现在greenDAO升级到了3.0版本，不需要java项目了</p>
<p>强烈建议升级到3.0版本，该版本采用注解的方式通过编译生成Java数据对象和DAO对象，配置更简单</p>
<p>之前2.0版本的配置也写过，参考这里：<a href="https://jp1017.github.io/2015/12/20/Android-SQLite-ORM%E6%A1%86%E6%9E%B6greenDAO%E5%9C%A8Android-Studio%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8/">Android SQLite ORM框架greenDAO在Android Studio中的配置与使用</a></p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="greenDAO" scheme="http://jp1017.github.io/tags/greenDAO/"/>
    
      <category term="数据库" scheme="http://jp1017.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[删除 Ubuntu 系统旧内核]]></title>
    <link href="http://jp1017.github.io/2016/10/11/%E5%88%A0%E9%99%A4-Ubuntu-%E7%B3%BB%E7%BB%9F%E6%97%A7%E5%86%85%E6%A0%B8/"/>
    <id>http://jp1017.github.io/2016/10/11/删除-Ubuntu-系统旧内核/</id>
    <published>2016-10-11T05:21:58.000Z</published>
    <updated>2016-10-14T12:59:41.097Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/153625563/m%3D2048/67caa338644b5cc0d41766f4743e64c9" alt="每日一景"></p>
<h2 id="警告">警告</h2><p><strong>删内核前请保存好您的数据信息</strong></p>
<p>随着每次升级 Ubuntu 系统，占用空间都会增大，虽然我们可以通过命令</p>
<blockquote>
<p>sudo apt-get autoclean<br>sudo apt-get autoremove</p>
</blockquote>
<p>来删除一些不必要的资源，但是系统内核还残留在硬盘里，而这些都是无用的，直到最近，boot 启动盘空间已满，导致系统出现bug，那么删除无用的内核势在必行。</p>
<a id="more"></a>
<h2 id="查看内核">查看内核</h2><p>可以通过命令</p>
<blockquote>
<p>uname -a</p>
</blockquote>
<p>查看当前系统内核信息，我的是最新的：</p>
<blockquote>
<p>jp@jp-INST ~&gt; uname -a<br>Linux jp-INST 4.4.0-42-generic #62-Ubuntu SMP Fri Oct 7 23:11:45 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</p>
</blockquote>
<p>那么如何查看已经存在的内核呢，下面命令可以</p>
<blockquote>
<p>dpkg –get-selections| grep linux</p>
</blockquote>
<p>我的系统如下：</p>
<blockquote>
<p>[jp-INST:~]<br>[jp]% dpkg –get-selections| grep linux<br>console-setup-linux                install<br>libselinux1:amd64                install<br>libselinux1:i386                install<br>linux-base                    install<br>linux-firmware                    install<br>linux-generic                    install<br>linux-headers-4.4.0-22                install<br>linux-headers-4.4.0-22-generic            install<br>linux-headers-4.4.0-24                install<br>linux-headers-4.4.0-24-generic            install<br>linux-headers-4.4.0-28                install<br>linux-headers-4.4.0-28-generic            install<br>linux-headers-4.4.0-31                install<br>linux-headers-4.4.0-31-generic            install<br>linux-headers-4.4.0-34                install<br>linux-headers-4.4.0-34-generic            install<br>linux-headers-4.4.0-36                install<br>linux-headers-4.4.0-36-generic            install<br>linux-headers-4.4.0-38                install<br>linux-headers-4.4.0-38-generic            install<br>linux-headers-4.4.0-42                install<br>linux-headers-4.4.0-42-generic            install<br>linux-headers-generic                install<br>linux-image-4.2.0-21-generic            deinstall<br>linux-image-4.2.0-22-generic            deinstall<br>linux-image-4.4.0-31-generic            deinstall<br>linux-image-4.4.0-34-generic            install<br>linux-image-4.4.0-36-generic            install<br>linux-image-4.4.0-38-generic            install<br>linux-image-4.4.0-42-generic            install<br>linux-image-extra-4.2.0-21-generic        deinstall<br>linux-image-extra-4.4.0-31-generic        deinstall<br>linux-image-extra-4.4.0-34-generic        deinstall<br>linux-image-extra-4.4.0-36-generic        deinstall<br>linux-image-extra-4.4.0-38-generic        install<br>linux-image-extra-4.4.0-42-generic        install<br>linux-image-generic                install<br>linux-libc-dev:amd64                install<br>linux-sound-base                install<br>pptp-linux                    install<br>syslinux                    install<br>syslinux-common                    install<br>syslinux-legacy                    install<br>util-linux                    install</p>
</blockquote>
<h2 id="卸载内核">卸载内核</h2><p>可以看到系统已经安装了多个内核版本，包括 <code>headers</code> 和 <code>image</code> ，可以删除这些来卸载旧的内核，</p>
<p>比如删除 <code>4.4.0-22</code> 内核，我们看到上面只有 <code>headers</code>，因此可以这样：</p>
<blockquote>
<p>[jp-INST:~]<br>[jp]% sudo apt-get remove linux-headers-4.4.0-22<br>正在读取软件包列表… 完成<br>正在分析软件包的依赖关系树<br>正在读取状态信息… 完成<br>下列软件包将被【卸载】：<br>  linux-headers-4.4.0-22 linux-headers-4.4.0-22-generic<br>升级了 0 个软件包，新安装了 0 个软件包，要卸载 2 个软件包，有 0 个软件包未被升级。<br>解压缩后将会空出 77.5 MB 的空间。<br>您希望继续执行吗？ [Y/n] y<br>(正在读取数据库 … 系统当前共安装有 420370 个文件和目录。)<br>正在卸载 linux-headers-4.4.0-22-generic (4.4.0-22.40) …<br>正在卸载 linux-headers-4.4.0-22 (4.4.0-22.40) …<br>[jp-INST:~]<br>[jp]% </p>
</blockquote>
<p>这样就卸载了 <code>4.4.0-22</code> 内核，会询问是否执行，输入 y 即可，卸载完成后会回到命令行。</p>
<p>其他的内核类似。</p>
<h2 id="再次警告">再次警告</h2><p><strong>删内核前请保存好您的数据信息</strong></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/153625563/m%3D2048/67caa338644b5cc0d41766f4743e64c9" alt="每日一景"></p>
<h2 id="警告">警告</h2><p><strong>删内核前请保存好您的数据信息</strong></p>
<p>随着每次升级 Ubuntu 系统，占用空间都会增大，虽然我们可以通过命令</p>
<blockquote>
<p>sudo apt-get autoclean<br>sudo apt-get autoremove</p>
</blockquote>
<p>来删除一些不必要的资源，但是系统内核还残留在硬盘里，而这些都是无用的，直到最近，boot 启动盘空间已满，导致系统出现bug，那么删除无用的内核势在必行。</p>]]>
    
    </summary>
    
      <category term="ubuntu" scheme="http://jp1017.github.io/tags/ubuntu/"/>
    
      <category term="ubuntu" scheme="http://jp1017.github.io/categories/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[安卓应用修改系统时间]]></title>
    <link href="http://jp1017.github.io/2016/09/25/%E5%AE%89%E5%8D%93%E5%BA%94%E7%94%A8%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4/"/>
    <id>http://jp1017.github.io/2016/09/25/安卓应用修改系统时间/</id>
    <published>2016-09-25T12:40:12.000Z</published>
    <updated>2016-09-26T10:41:33.802Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/127578853/m%3D2048/3e76397841f23f0bcb16c5e1fa523046" alt="每日一景"></p>
<h1 id="前言">前言</h1><hr>
<p>通常，我们来获取系统时间来做一些事情，那么，如何设置系统时间呢？</p>
<p>问题抛出来，解决方法也就应运而生了。</p>
<h1 id="解决方法">解决方法</h1><hr>
<h2 id="命令行">命令行</h2><p>首先我想到的是手机root，然后命令行</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">date</span> -s 要设置的时间</span><br></pre></td></tr></table></figure>
<p>关于如何调用命令行，请点击：<a href="http://www.jianshu.com/p/603f29a6a513" target="_blank" rel="external">安卓程序中调用 linux 命令</a></p>
<p>如果手机没 root 怎么破呢，继续往下看吧。</p>
<a id="more"></a>
<h2 id="获取系统权限修改">获取系统权限修改</h2><p>没有 root 的话，可以获取系统权限来设置，怎么设置呢，这个文章已经给出：</p>
<p><a href="http://www.programgo.com/article/54422482620/" target="_blank" rel="external">如何使Android应用程序获取系统权限来修改系统时间</a></p>
<p>就是系统签名了。</p>
<p>这里说明一点，由于在manifest文件加入android:sharedUserId=”android.uid.system”这个属性，导致 Android Studio 等工具，直接编译运行会出现此提示窗：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160925211654.jpg" alt="error"></p>
<p>多次点击 ok 无效，因为设置了系统属性，所以，下次你运行别的项目，出现此情况时，可以检查下时候添加了该属性的，有的话，去掉，再编译运行就可以的。</p>
<p>获取了权限了，一行代码就可以设置时间：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">SystemClock</span><span class="class">.setCurrentTimeMillis</span>(<span class="tag">millTime</span>);</span><br></pre></td></tr></table></figure>
<p>参数是1970后跑过的毫秒数。</p>
<p>那么问题来了，如何获取这个时间呢，下面有三种方法：</p>
<p>1.gps时间</p>
<p>可以通过 gps 定位，获取 gps 时间，此处原生安卓代码，百度，高德都可实现，具体请参考相应 api。</p>
<p>2.网络</p>
<p>找到一篇文章，是这么个姿势：</p>
<p><a href="http://blog.csdn.net/catoop/article/details/50076879" target="_blank" rel="external">获取网络时间（国家标准时间）</a></p>
<p>很巧妙，有木有啊，读取网站时间，哈哈，有个问题，网站不稳定时，会出错的。</p>
<p>3.TrueTime</p>
<p>地址：<a href="https://github.com/instacart/truetime-android" target="_blank" rel="external">https://github.com/instacart/truetime-android</a></p>
<p>这个是今天在 GitHub 上发现的库，可以设置 NTP 服务器，来获取时间，使用也很简单</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置中科大ftp服务器</span></span><br><span class="line">TrueTime<span class="built_in">.</span>build()<span class="built_in">.</span>withNtpHost(<span class="string">"time.ustc.edu.cn"</span>)<span class="built_in">.</span>initialize();</span><br><span class="line"><span class="built_in">Date</span> <span class="built_in">date</span> = TrueTime<span class="built_in">.</span>now();</span><br></pre></td></tr></table></figure>
<p>然后 date.getTime() 获取毫秒数，设置时间就可以了。</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/127578853/m%3D2048/3e76397841f23f0bcb16c5e1fa523046" alt="每日一景"></p>
<h1 id="前言">前言</h1><hr>
<p>通常，我们来获取系统时间来做一些事情，那么，如何设置系统时间呢？</p>
<p>问题抛出来，解决方法也就应运而生了。</p>
<h1 id="解决方法">解决方法</h1><hr>
<h2 id="命令行">命令行</h2><p>首先我想到的是手机root，然后命令行</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">date</span> -s 要设置的时间</span><br></pre></td></tr></table></figure>
<p>关于如何调用命令行，请点击：<a href="http://www.jianshu.com/p/603f29a6a513">安卓程序中调用 linux 命令</a></p>
<p>如果手机没 root 怎么破呢，继续往下看吧。</p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="系统时间" scheme="http://jp1017.github.io/tags/%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[USB摄像头预览识别二维码]]></title>
    <link href="http://jp1017.github.io/2016/09/15/USB%E6%91%84%E5%83%8F%E5%A4%B4%E9%A2%84%E8%A7%88%E8%AF%86%E5%88%AB%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
    <id>http://jp1017.github.io/2016/09/15/USB摄像头预览识别二维码/</id>
    <published>2016-09-15T08:51:43.000Z</published>
    <updated>2016-09-26T10:26:44.578Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/114230539/m%3D2048/6ebd8909ba23a7570389e1ecc5ab39ac" alt="每日一景"></p>
<h2 id="前言">前言</h2><hr>
<p>二维码现在用的超级多，其实它就是一种编码，把字符串编码保存成一个图片，我们扫描图片得到字符串就解码成功。</p>
<p>最有名的二维码解析库是 google 出品的 <code>Zxing</code>,网上也有很多的封装库，有自定义扫描窗口等，更多库请在这个库中搜索 <code>二维码</code>即可：</p>
<p><a href="https://github.com/XXApple/AndroidLibs/tree/master/%E5%9B%BE%E7%89%87%E6%A1%86%E6%9E%B6Image" target="_blank" rel="external">安卓各种图片框架</a></p>
<p>这些库采用的都是手机自带的摄像头，没有USB摄像头，悲催了。</p>
<p>USB摄像头拍照，摄像，网上有一个很牛的开源库：</p>
<p><a href="https://github.com/saki4510t/UVCCamera" target="_blank" rel="external">UVCCamera</a></p>
<p>我也是参考了这个库，在其基础上开发，主要是采用了test4，开启服务来拍照，摄像。这里有几个坑，耽搁了一整天啊。</p>
<p>这里涉及两方面内容，识别代码和扫描界面</p>
<a id="more"></a>
<h2 id="识别代码">识别代码</h2><hr>
<p>代码里如何实现呢，一开始一点思路都没有啊。</p>
<p>手机摄像头预览识别，可参考：</p>
<p><a href="https://github.com/bingoogolapple/BGAQRCode-Android/issues/55" target="_blank" rel="external">https://github.com/bingoogolapple/BGAQRCode-Android/issues/55</a></p>
<p>那么USB摄像头如何实现呢，那么只能到 <code>UVCCamera</code> 这个库里去寻找答案，没办法，只能静下心来好好看。</p>
<p>我的二维码识别也采用了开源库：</p>
<p><a href="https://github.com/yipianfengye/android-zxingLibrary" target="_blank" rel="external">https://github.com/yipianfengye/android-zxingLibrary</a></p>
<p>这个库在使用中有小bug，我都提了PR，自行解决了。</p>
<p>我注意到，该库可以根据 <code>Bitmap</code> 对象识别，那么哪里会有这个对象呢，最先想到的是拍照，点击拍照的时候，一定会有这些数据，那么这些数据在哪里呢，一层一层的剥开，最终在<code>RendererHolder</code> 的 run 方法里找到偶遇 bitmap， 然后他识别二维码的代码移植到这里，点击拍照，果然能识别到二维码，哇哈，成功了一丝丝，最开始以为就先这样实现就可以的。</p>
<p>扫描结束后，要弹个窗口提示下扫描结果啊是不是，这个简单啊，用EventBus啊，然后EventBus一开挂，见证奇迹的时刻：</p>
<p>然而奇迹并没有出现，一直订阅不到，然后各种追寻，未果。</p>
<p>然后尝试了另一个开源库 Router，然而，这个库也没有成功，然后一天就这么嗖嗖的过去了，中间找到 Router的作者，我写了个demo给他，他看后提示我是不是 <code>多进程</code>，Router 和 EventBus 都是不支持多进程的。</p>
<p>我赶紧去确认了下，该拍照摄像service设置了远程标志：</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="label">android:</span>process=<span class="string">":uvcservice"</span></span><br></pre></td></tr></table></figure>
<p>没跑了，确实跨进程通信了。</p>
<p>那么，怎么搞呢，广播咯，于是用广播实现了扫描后的结果通知。</p>
<p>暂时实现的功能是点击拍照按钮，扫描二维码，这就结束了吗？</p>
<h2 id="扫描界面">扫描界面</h2><hr>
<p>界面又该如何实现呢，比如实现微信类似的二维码识别界面。查看了很多自定义二维码识别的界面，都是自定义View，然后重写 onDraw 方法，自定义扫码边框及扫描动画，比如这里：</p>
<p><a href="https://github.com/yipianfengye/android-zxingLibrary/blob/master/lib-zxing/src/main/java/com/uuzuche/lib_zxing/view/ViewfinderView.java" target="_blank" rel="external">ViewfinderView</a></p>
<p>然后查看了下USB摄像库，显示画面的View是继承自 <code>TextureView</code> 的，然后想在此 <code>TextureView</code> 里也重写 onDraw实现，但是发现TextureView里的此方法是final的，也就是不能在绘制别的东西了。查看了下源码，里面的注释里有这样一段话：</p>
<blockquote>
<p>It is important to note that only one producer can use the TextureView.<br>For instance, if you use a TextureView to display the camera preview, you<br>cannot use {@link #lockCanvas()} to draw onto the TextureView at the same<br>time.</p>
</blockquote>
<p>大体意思就是不能在TextureView上获取Canvas再绘制view，这样看来此路不通啊。</p>
<p>但是有了新的发现，这个发现正好解决了之前的预览识别问题，究竟是什么呢？</p>
<p>TextureView 的使用很简单，两步：</p>
<ol>
<li>获取这个TextureView,</li>
<li>设置setSurfaceTextureListener，实现其四个方法</li>
</ol>
<p>具体使用可查看下面两个文章：</p>
<p><a href="http://blog.csdn.net/elinavampire/article/details/51690991" target="_blank" rel="external">TextureView 使用</a><br><a href="http://www.jianshu.com/p/b2d949ab1a1a" target="_blank" rel="external">TextureView+SurfaceTexture+OpenGL ES来播放视频（二）</a></p>
<p>在这个listener的源码中，发现 <code>onSurfaceTextureUpdated</code> 方法在每次变化的时候都会调用，也就是预览时会频繁调用，于是，在此方法里打印，果然如此，那么就可以在此方法里去实现预览识别啊。</p>
<p>想法不错，但是该如何去做呢，继续查看UVCCamera源码，发现，里面有个Callback的接口，该接口在拍照的fragment里有实现，但是没有具体实现，而该接口也没有update的调用，于是，我加了个方法：</p>
<p><code>onSurfaceUpdate(Surface surface);</code></p>
<p>并实现了该方法，那么剩下的就是在该方法里去扫描二维码，发现TextureView有个方法，<code>getBitmap</code>,这是极好的，通过此bitmap对象就可以扫描二维码了，bingo。</p>
<p>实际操作，确实也是这样的，哈哈，太棒了，此刻见证了一个真理：</p>
<blockquote>
<p>源码是最好的老师</p>
</blockquote>
<p>这样，无心插柳，解决了预览识别二维码的问题，但是界面还木有出来啊，怎么弄呢，不能Canvas绘制了，那么就在此TextureView周围添加一个边框吧。</p>
<p>至于扫描动画，也是设置的一个图片的平移动画，没什么可说的，有了思路，剩下的就好办了。</p>
<p>实际图如下：</p>
<p><img src="https://raw.githubusercontent.com/jp1017/UVCCameraZxing/master/1.png" width="270"> <img src="https://raw.githubusercontent.com/jp1017/UVCCameraZxing/master/2.png" width="270"> </p>
<p>代码已上传，请到这里查看：</p>
<p><a href="https://github.com/jp1017/UVCCameraZxing" target="_blank" rel="external">UVCCameraZxing</a></p>
<p>关于识别图片二维码，也是支持的，很多库都有这个功能的，不难，enjoy！</p>
<p>当然，对于，条形码也是支持的，赶快使用起来吧。</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/114230539/m%3D2048/6ebd8909ba23a7570389e1ecc5ab39ac" alt="每日一景"></p>
<h2 id="前言">前言</h2><hr>
<p>二维码现在用的超级多，其实它就是一种编码，把字符串编码保存成一个图片，我们扫描图片得到字符串就解码成功。</p>
<p>最有名的二维码解析库是 google 出品的 <code>Zxing</code>,网上也有很多的封装库，有自定义扫描窗口等，更多库请在这个库中搜索 <code>二维码</code>即可：</p>
<p><a href="https://github.com/XXApple/AndroidLibs/tree/master/%E5%9B%BE%E7%89%87%E6%A1%86%E6%9E%B6Image">安卓各种图片框架</a></p>
<p>这些库采用的都是手机自带的摄像头，没有USB摄像头，悲催了。</p>
<p>USB摄像头拍照，摄像，网上有一个很牛的开源库：</p>
<p><a href="https://github.com/saki4510t/UVCCamera">UVCCamera</a></p>
<p>我也是参考了这个库，在其基础上开发，主要是采用了test4，开启服务来拍照，摄像。这里有几个坑，耽搁了一整天啊。</p>
<p>这里涉及两方面内容，识别代码和扫描界面</p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="USB摄像头" scheme="http://jp1017.github.io/tags/USB%E6%91%84%E5%83%8F%E5%A4%B4/"/>
    
      <category term="二维码" scheme="http://jp1017.github.io/tags/%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[安卓开发之屏蔽按键抖动，连击，长按事件]]></title>
    <link href="http://jp1017.github.io/2016/08/28/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E4%B9%8B%E5%B1%8F%E8%94%BD%E6%8C%89%E9%94%AE%E6%8A%96%E5%8A%A8%EF%BC%8C%E8%BF%9E%E5%87%BB%EF%BC%8C%E9%95%BF%E6%8C%89%E4%BA%8B%E4%BB%B6/"/>
    <id>http://jp1017.github.io/2016/08/28/安卓开发之屏蔽按键抖动，连击，长按事件/</id>
    <published>2016-08-28T12:45:43.000Z</published>
    <updated>2016-08-28T13:36:25.573Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/70950171/m%3D2048/25f837d354504c2a249d46a740905e36" alt="每日一景"></p>
<h1 id="缘由">缘由</h1><hr>
<p>今天来个小知识点，也许遇到的人不多，但还是记录下。现在安卓机很少有实体键，老罗的情怀也只剩下一丝丝。但是除去手机，其他一些设备，比如电视，盒子等很多还有实体键，那么实体键在按下后就有一些问题，“抖动”和“连击”。</p>
<p>在开发中，我这里有一个很重要的操作，是实体键触发的，在实际测试中，会出现按下一次，多次触发的问题，那么就需要解决下，其实，解决方法也不难，我们开始吧。</p>
<a id="more"></a>
<h2 id="“抖动”，“连击”">“抖动”，“连击”</h2><hr>
<p>“抖动”和“连击”是类似的错误操作，可以根据时间来判断，和双击退出 app 的操作是一样的，因此可以重写 <code>onKeyDown</code> 方法：</p>
<p>这里以<code>音量-</code>为例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">double</span> DOUBLE_CLICK_TIME = <span class="number">0L</span>;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyDown</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event.getKeyCode() == KeyEvent.KEYCODE_VOLUME_DOWN ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((System.currentTimeMillis() - DOUBLE_CLICK_TIME) &gt; <span class="number">1500</span>) &#123;<span class="comment">//这里测试1500ms比较合适</span></span><br><span class="line">            DOUBLE_CLICK_TIME = System.currentTimeMillis();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//这里执行单击后的操作</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyDown(keyCode, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里很好理解，只有两次点击的时间大于 <code>1500ms</code> 才有效，那么抖动和连击都是无效的。</p>
<h2 id="”长按“">”长按“</h2><hr>
<p>默认情况下，我们不做处理的话，一直按住某个按键，是多次单击操作，大家一直按住<code>音量-</code>就会把声音减小到最小。</p>
<p>如果我不做处理，用户一直按着这个键，或者时间稍长，就相当于按了多次，这会导致误操作，因此需要特殊照顾下咯。</p>
<p>直接重写 <code>onKeyLongPress</code> 方法，测试，不调用，那么，肯定是哪里拦截了，google 了下，在万能的 <code>StackOverflow</code> 找到答案：</p>
<p>链接：<a href="https://stackoverflow.com/questions/12950215/onkeydown-and-onkeylongpress" target="_blank" rel="external">onKeyDown and onKeyLongPress</a></p>
<p>这里添加了一个 标记：shortPress,</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> shortPress = <span class="keyword">false</span>;</span><br><span class="line"> </span><br><span class="line"><span class="annotation">@Override</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyLongPress</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) &#123;</span><br><span class="line">        shortPress = <span class="keyword">false</span>;</span><br><span class="line">        Toast.makeText(<span class="keyword">this</span>, <span class="string">"longPress"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//Just return false because the super call does always the same (returning false) </span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="annotation">@Override</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyDown</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) &#123;</span><br><span class="line">        <span class="keyword">if</span>(event.getAction() == KeyEvent.ACTION_DOWN)&#123;</span><br><span class="line">            event.startTracking();</span><br><span class="line">            <span class="keyword">if</span>(event.getRepeatCount() == <span class="number">0</span>)&#123;</span><br><span class="line">                shortPress = <span class="keyword">true</span>;</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyDown(keyCode, event);</span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="annotation">@Override</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyUp</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) &#123;</span><br><span class="line">        <span class="keyword">if</span>(shortPress)&#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"shortPress"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="comment">//Don't handle longpress here, because the user will have to get his finger back up first </span></span><br><span class="line">        &#125; </span><br><span class="line">        shortPress = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyUp(keyCode, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="综合解决">综合解决</h1><hr>
<p>综合上面的分析，把两种情况综合起来，最终解决方案如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">double</span> DOUBLE_CLICK_TIME = <span class="number">0L</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> shortPress = <span class="keyword">false</span>;</span><br><span class="line"> </span><br><span class="line"><span class="annotation">@Override</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyLongPress</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) &#123;</span><br><span class="line">        shortPress = <span class="keyword">false</span>;</span><br><span class="line">        Toast.makeText(<span class="keyword">this</span>, <span class="string">"longPress"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//Just return false because the super call does always the same (returning false) </span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="annotation">@Override</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyDown</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) &#123;</span><br><span class="line">        <span class="keyword">if</span>(event.getAction() == KeyEvent.ACTION_DOWN)&#123;</span><br><span class="line">            event.startTracking();</span><br><span class="line">            <span class="keyword">if</span>(event.getRepeatCount() == <span class="number">0</span>)&#123;</span><br><span class="line">                shortPress = <span class="keyword">true</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> ((System.currentTimeMillis() - DOUBLE_CLICK_TIME) &gt; <span class="number">1500</span>) &#123;<span class="comment">//这里测试1500ms比较合适</span></span><br><span class="line">                DOUBLE_CLICK_TIME = System.currentTimeMillis();</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//这里执行单击后的操作</span></span><br><span class="line">               </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">            &#125; </span><br><span class="line">            </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyDown(keyCode, event);</span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="annotation">@Override</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKeyUp</span><span class="params">(<span class="keyword">int</span> keyCode, KeyEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN) &#123;</span><br><span class="line">        <span class="keyword">if</span>(shortPress)&#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"shortPress"</span>, Toast.LENGTH_LONG).show();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="comment">//Don't handle longpress here, because the user will have to get his finger back up first </span></span><br><span class="line">        &#125; </span><br><span class="line">        shortPress = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onKeyUp(keyCode, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好了，到这里就结束了。</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/70950171/m%3D2048/25f837d354504c2a249d46a740905e36" alt="每日一景"></p>
<h1 id="缘由">缘由</h1><hr>
<p>今天来个小知识点，也许遇到的人不多，但还是记录下。现在安卓机很少有实体键，老罗的情怀也只剩下一丝丝。但是除去手机，其他一些设备，比如电视，盒子等很多还有实体键，那么实体键在按下后就有一些问题，“抖动”和“连击”。</p>
<p>在开发中，我这里有一个很重要的操作，是实体键触发的，在实际测试中，会出现按下一次，多次触发的问题，那么就需要解决下，其实，解决方法也不难，我们开始吧。</p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="事件" scheme="http://jp1017.github.io/tags/%E4%BA%8B%E4%BB%B6/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ViewPager 嵌套百度地图事件冲突的解决方法]]></title>
    <link href="http://jp1017.github.io/2016/07/28/ViewPager-%E5%B5%8C%E5%A5%97%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%E4%BA%8B%E4%BB%B6%E5%86%B2%E7%AA%81%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <id>http://jp1017.github.io/2016/07/28/ViewPager-嵌套百度地图事件冲突的解决方法/</id>
    <published>2016-07-28T13:18:46.000Z</published>
    <updated>2016-08-02T13:45:04.148Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/72751293/m%3D2048/49a274baba6d51c1242995a4d4654c70" alt="每日一景"></p>
<h1 id="问题">问题</h1><hr>
<p>主 Activity 由一个自定义的 ViewPager 控制，包含多个 fragment，其中一个 fragment 包含一个百度地图 View，当左右滑动百度地图的时候，地图不动，只能望着 ViewPager 左右滑动的脚步而叹息，导致事件冲突。</p>
<h1 id="解决之路">解决之路</h1><hr>
<p>这个问题从开始就有，只是感觉事件分发有些复杂，没深入研究，网上很多大神关于这个知识点有很多的分享，也收获了不少，曾经按照《开发艺术探索》里的方法解决，最终地图的事件解决，又导致其他 View 冲突，不能操作，这个真心没法忍啊。</p>
<p>这个问题一直在我的心里，始终没有放下，只要看到关于事件分发的文章，我都会看一下，看能否对此有帮助，然而，一无所获。</p>
<p>直到今天，晚上，有心人天不负，无意的，我看到一个群里的群主这么写到：</p>
<a id="more"></a>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160728212904.jpg" alt="mobdevgroup"></p>
<p>在安卓界，这个群主的头像相信大家应该不会陌生，这里给出他的博客以表感谢：<a href="http://mobdevgroup.com/" target="_blank" rel="external">移动平台资源整理和分享</a></p>
<p>没错，就是 <code>ViewGroup</code> 的 <code>requestDisallowInterceptTouchEvent</code> 方法</p>
<p>然后一顿 google，该方法的使用还是真多啊，看来有戏，首先进入这里：<a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2013/0803/1500.html" target="_blank" rel="external">用requestDisallowInterceptTouchEvent()方法防止viewpager和子view冲突</a>，这里说的很清楚：</p>
<blockquote>
<p>当用户按下的时候，我们告诉父组件，不要拦截我的事件（这个时候子组件是可以正常响应事件的），拿起之后就会告诉父组件可以阻止。</p>
</blockquote>
<p>然后就开始实践了，我的代码如下：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> MyViewPage pager = <span class="keyword">new</span> MyViewPage(getBaseActivity());</span><br><span class="line">mMapView.setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">    KLog.w(<span class="string">"upupupupup    upupupupup"</span>);</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionmove"</span>);</span><br><span class="line">                pager.requestDisallowInterceptTouchEvent(<span class="keyword">true</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionup"</span>);</span><br><span class="line">                pager.requestDisallowInterceptTouchEvent(<span class="keyword">false</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>然而，程序跑起来后，一个都没有打印。没运行？编译器没刷新？然后 clean，sync, rebuld,run,问题依旧，看来是没有运行了。</p>
<p>那自定义一个 MapView，发现 MapView 是 final，根本继承不了。</p>
<p>然后来到了这里：<a href="http://bbs.lbsyun.baidu.com/forum.php?mod=viewthread&amp;tid=15245" target="_blank" rel="external">百度地图和scrollview使用冲突问题</a>，三楼的朋友给出了解决方案，既然地图不可继承，那就自定义地图容器，在容器里进行该操作，然后自定义好地图容器，把容器写到布局里，并把容器布局和 ViewPager 联系起来，运行后，方法是运行了，但是问题依旧。</p>
<p>既然能运行，那拦截的可能有问题咯，或者联系的这个 ViewPager 可能不是同一个，该如何继续？？？</p>
<p>又看到了这个：<a href="http://blog.csdn.net/theone10211024/article/details/44649289" target="_blank" rel="external">运项目难点之ScrollView中嵌套百度地图（BaiduMap）的解决方案</a></p>
<p>该作者也遇到了我的这个问题，百度这个坑确实深啊，作者在无望的情况下，反编译了地图 jar 包，在下佩服的五体投地，最终作者发现拦截 <code>MapView.OnTouchListener.onTouch()</code>的是地图图层 <code>mMapView.getChildAt(0)</code></p>
<p>于是，删掉地图容器类，回到最开始的地图布局，用地图图层处理事件，修改代码如下：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> MyViewPage pager = <span class="keyword">new</span> MyViewPage(getBaseActivity());</span><br><span class="line">mMapView.getChildAt(<span class="number">0</span>).setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">    KLog.w(<span class="string">"upupupupup    upupupupup"</span>);</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionmove"</span>);</span><br><span class="line">                pager.requestDisallowInterceptTouchEvent(<span class="keyword">true</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionup"</span>);</span><br><span class="line">                pager.requestDisallowInterceptTouchEvent(<span class="keyword">false</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>运行后，问题依然存在，和容器类的效果类似，该图层确实获取到了该事件，但是仍然被 ViewPager 拦截了，so，问题只能是执行 <code>requestDisallowInterceptTouchEvent</code> 的这个 pager 有问题，我们看到，这个 pager 我是直接 new 出来的，那么修改下这个 pager？</p>
<p>我注意到，onTouch 方法里的第一个参数 View，还没有用，那么就该在这里下手了，于是最终代码来了：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mMapView.getChildAt(<span class="number">0</span>).setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionmove"</span>);</span><br><span class="line"></span><br><span class="line">                v.getParent().requestDisallowInterceptTouchEvent(<span class="keyword">true</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionup"</span>);</span><br><span class="line">                v.getParent().requestDisallowInterceptTouchEvent(<span class="keyword">false</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>没错，把 <code>pager</code> 换成 <code>v.getParent()</code>，这样就解决了我这个历史遗留问题，希望能为后面遇到该问题的小伙伴提供些许思路，感谢大家的观看，谢谢！</p>
<h1 id="2016-08-02_更新另外两种解决方案">2016.08.02 更新另外两种解决方案</h1><p>1 文章发布当天，有朋友回复，说 <code>v.getParent()</code> 方法就是 mMapView，想来也是，于是这样解决也是可以的：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mMapView.getChildAt(<span class="number">0</span>).setOnTouchListener(<span class="keyword">new</span> View.OnTouchListener() &#123;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionmove"</span>);</span><br><span class="line"></span><br><span class="line">                mMapView.requestDisallowInterceptTouchEvent(<span class="keyword">true</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                KLog.w(<span class="string">"upupupupup    actionup"</span>);</span><br><span class="line">                mMapView.requestDisallowInterceptTouchEvent(<span class="keyword">false</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>2 后来遇到百度地图单指不能滑动问题，多方咨询后无果，因此改用高德地图，没想到高德地图一切运行良好，当然也遇到滑动冲突问题，这个解决和百度地图的有些不同，但找到了通用方案：</p>
<p><a href="http://blog.csdn.net/qq_31469369/article/details/51766871" target="_blank" rel="external">fragment中加载高德地图出现滑动冲突解决</a></p>
<p>看代码就明白了，就是重写 ViewPager 的 canScroll 方法，判断下，如果当前滑动的是百度地图或高德地图，则返回 true， 地图正常滑动。</p>
<p>所以，这个通用方法还是很棒的，代码稍微修改如下：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">boolean</span> <span class="title">canScroll</span><span class="params">(View v, <span class="keyword">boolean</span> checkV, <span class="keyword">int</span> dx, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> v.getClass().getName().equals(<span class="string">"com.baidu.mapapi.map.MapView"</span>)</span><br><span class="line">			|| v.getClass().getName().equals(<span class="string">"com.amap.api.maps.MapView"</span>)</span><br><span class="line">			|| <span class="keyword">super</span>.canScroll(v, checkV, dx, x, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/72751293/m%3D2048/49a274baba6d51c1242995a4d4654c70" alt="每日一景"></p>
<h1 id="问题">问题</h1><hr>
<p>主 Activity 由一个自定义的 ViewPager 控制，包含多个 fragment，其中一个 fragment 包含一个百度地图 View，当左右滑动百度地图的时候，地图不动，只能望着 ViewPager 左右滑动的脚步而叹息，导致事件冲突。</p>
<h1 id="解决之路">解决之路</h1><hr>
<p>这个问题从开始就有，只是感觉事件分发有些复杂，没深入研究，网上很多大神关于这个知识点有很多的分享，也收获了不少，曾经按照《开发艺术探索》里的方法解决，最终地图的事件解决，又导致其他 View 冲突，不能操作，这个真心没法忍啊。</p>
<p>这个问题一直在我的心里，始终没有放下，只要看到关于事件分发的文章，我都会看一下，看能否对此有帮助，然而，一无所获。</p>
<p>直到今天，晚上，有心人天不负，无意的，我看到一个群里的群主这么写到：</p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="ViewPager" scheme="http://jp1017.github.io/tags/ViewPager/"/>
    
      <category term="事件分发" scheme="http://jp1017.github.io/tags/%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91/"/>
    
      <category term="百度地图" scheme="http://jp1017.github.io/tags/%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Android Studio 引用系统 jar 包的正确姿势]]></title>
    <link href="http://jp1017.github.io/2016/07/11/Android-Studio-%E5%BC%95%E7%94%A8%E7%B3%BB%E7%BB%9F-jar-%E5%8C%85%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF/"/>
    <id>http://jp1017.github.io/2016/07/11/Android-Studio-引用系统-jar-包的正确姿势/</id>
    <published>2016-07-11T09:46:59.000Z</published>
    <updated>2016-07-11T10:31:34.777Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/118785927/m%3D2048/51dda482036d6d91f2902406c3e8f41f" alt="每日一景"></p>
<p>Android Studio 如何引用 jar 包，相信大家都会操作的，现在问题来了，对于系统里的 jar，比如 framework.jar该如何配置呢？</p>
<p>这里来个简单的需求吧，我们自己编译系统，并且有串口驱动，该驱动有提供 so 和 jar。这些文件配置到系统里面，当jar更新，api 不变的话，只要更新系统就可以，而应用程序可以不变而采用系统最新的 jar 包。</p>
<p>也就是说，编译时引用jar包，而不把该 jar 打包进 apk，而apk运行时采用系统里面的 jar 即可。</p>
<p>这个需求在 eclipse 里面很好配置，只要设置 jar 为系统 jar 就可以，那么 AS 该如何配置呢？</p>
<a id="more"></a>
<p>AS 采用 gradle 编译，那么配置 gradle 就可以的，google 后来到了这里：</p>
<p><a href="http://blog.csdn.net/zhuzp_blog/article/details/51674468" target="_blank" rel="external"> Android Studio导入framework.jar等系统jar包方式</a></p>
<p>也就是说配置 jar 包时采用 <code>provided</code> scope，比如：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">provided <span class="function"><span class="title">files</span><span class="params">(<span class="string">'libs/BaiduLBS_Android.jar'</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>这里采用 <code>provided</code>，意思是说编译时引用 <code>BaiduLBS_Android.jar</code>,而不把该 jar 打包进 apk。<br>而我们常用的是 <code>compile</code>，意思是编译时引用 jar 包，并打包进 apk。</p>
<p>配置好后，sync 出现错误：</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error:(<span class="number">26</span>, <span class="number">1</span>) Failed <span class="keyword">to</span> <span class="keyword">notify</span> build listener.</span><br><span class="line">&gt; Could <span class="keyword">not</span> get unknown <span class="keyword">property</span> <span class="string">'options'</span> <span class="keyword">for</span> root project <span class="string">'***'</span> <span class="keyword">of</span> <span class="keyword">type</span> org.gradle.api.Project.</span><br><span class="line">&gt; Could <span class="keyword">not</span> get unknown <span class="keyword">property</span> <span class="string">'options'</span> <span class="keyword">for</span> project <span class="string">':app'</span> <span class="keyword">of</span> <span class="keyword">type</span> org.gradle.api.Project.</span><br></pre></td></tr></table></figure>
<p>再次 google，无果，没人遇到过，，不知道当时作者怎么解决的，还没给我回复，后来删除 root gradle 配置部分，也就是仅仅修改 jar 包的引用方式为 <code>provided</code>，编译通过，运行后，出现异常：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java<span class="class">.lang</span><span class="class">.NoClassDefFoundError</span>: com<span class="class">.xx</span><span class="class">.xx</span></span><br></pre></td></tr></table></figure>
<p>说的很明白了，Class 找不到，因为没有把 jar 打包进 apk ，肯定找不到了，那么还需要配置别的地方，看来还得配置 root gradle ，但是上面的错误搜索不到，那么该如何进行下去，要换 eclipse 开发？显然这不能忍。。。</p>
<blockquote>
<p>非淡泊无以明志，非宁静无以致远</p>
</blockquote>
<p>没错，静下来，静下来，从最简单的开始。</p>
<p>看了下所长的 eclipse 版本项目，这仅仅是所长测试驱动调试使用的，移植到 AS 后，发现编译都不过，因为项目里没有 jar 包，那这个应用是如何跑起来的呢，然后在项目清单文件里找到了答案。</p>
<p><code>AndroidManifest.xml</code> 文件里有这样的配置：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="type">application</span></span><br><span class="line">    android:<span class="property">name</span>=<span class="string">".app.BaseApplication"</span></span><br><span class="line">    android:allowBackup=<span class="string">"true"</span></span><br><span class="line">    android:icon=<span class="string">"@mipmap/ic_launcher"</span></span><br><span class="line">    android:label=<span class="string">"@string/app_name"</span></span><br><span class="line">    android:supportsRtl=<span class="string">"true"</span></span><br><span class="line">    android:theme=<span class="string">"@style/AppTheme"</span>&gt;</span><br><span class="line">    &lt;uses-library android:<span class="property">name</span>=<span class="string">"com.**.**"</span> /&gt;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&lt;/<span class="type">application</span>&gt;</span><br></pre></td></tr></table></figure>
<p>大家都看到了，就是 <code>&lt;uses-library android:name=&quot;com.**.**&quot; /&gt;</code> 这一句，后面就是 jar 包的包名。</p>
<p>这样编译，运行都正常了，Bingo！</p>
<p>最后总结下，Android Studio 引用系统 jar 包需要配置两个内容：</p>
<ol>
<li><code>provided</code> 方式应用 jar 包，//编译时引用 jar 而不把 jar 打包进 apk</li>
<li>清单文件里配置 <code>&lt;uses-library android:name=&quot;com.**.**&quot; /&gt;</code> //告诉应用引用系统 jar 的包名</li>
</ol>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/118785927/m%3D2048/51dda482036d6d91f2902406c3e8f41f" alt="每日一景"></p>
<p>Android Studio 如何引用 jar 包，相信大家都会操作的，现在问题来了，对于系统里的 jar，比如 framework.jar该如何配置呢？</p>
<p>这里来个简单的需求吧，我们自己编译系统，并且有串口驱动，该驱动有提供 so 和 jar。这些文件配置到系统里面，当jar更新，api 不变的话，只要更新系统就可以，而应用程序可以不变而采用系统最新的 jar 包。</p>
<p>也就是说，编译时引用jar包，而不把该 jar 打包进 apk，而apk运行时采用系统里面的 jar 即可。</p>
<p>这个需求在 eclipse 里面很好配置，只要设置 jar 为系统 jar 就可以，那么 AS 该如何配置呢？</p>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/tags/Android-Studio/"/>
    
      <category term="jar" scheme="http://jp1017.github.io/tags/jar/"/>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/categories/Android-Studio/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[jni 开发错误之 java.lang.UnsatisfiedLinkError: dlopen failed: cannot locate symbol tcgetattr referenced by libserial_port.so...]]></title>
    <link href="http://jp1017.github.io/2016/06/30/jni-%E5%BC%80%E5%8F%91%E9%94%99%E8%AF%AF%E4%B9%8B-java-lang-UnsatisfiedLinkError-dlopen-failed-cannot-locate-symbol-tcgetattr-referenced-by-libserial-port-so/"/>
    <id>http://jp1017.github.io/2016/06/30/jni-开发错误之-java-lang-UnsatisfiedLinkError-dlopen-failed-cannot-locate-symbol-tcgetattr-referenced-by-libserial-port-so/</id>
    <published>2016-06-30T01:12:57.000Z</published>
    <updated>2016-06-30T10:10:32.336Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/133812917/m%3D2048/d7dab63e94897ec0ede8d33f5fdbb33f" alt="每日一景"></p>
<p>昨天把串口的驱动代码重新编译下，出现了问题：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java<span class="class">.lang</span><span class="class">.UnsatisfiedLinkError</span>: dlopen failed: cannot locate symbol tcgetattr referenced by libserial_port<span class="class">.so</span>...</span><br></pre></td></tr></table></figure>
<p>一般 jni 开发的话，C 代码命名常出错，检查了下，是 OK 的，然后 google了下，发现基本就下面两个：</p>
<p><a href="http://www.eoeandroid.com/thread-914514-1-1.html" target="_blank" rel="external">[Android 调试] android串口通信问题，基于android studio</a><br><a href="https://stackoverflow.com/questions/35080172/ndk-unsatisfiedlinkerror-when-lowering-project-api-level-21-to-19/38112597#38112597" target="_blank" rel="external">NDK UnsatisfiedLinkError when lowering project api level 21 to 19</a></p>
<p>而 stackoverflow 的哥们 rebuild 就好了，我各种折腾也不见好呐，于是看到上一篇 eoe 的，给了我思路：</p>
<p>我们看下包含该函数 <code>**tcgetattr**</code> 的文件， 比较下 NDK api 19 和 23 的 <code>termios.h</code> 文件：</p>
<p>23 的该文件目录：<code>D:\Android\Sdk\ndk-bundle\platforms\android-23\arch-arm\usr\include</code></p>
<a id="more"></a>
<p>api 23 下 termios.h 文件：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160630174226.jpg" alt="23"></p>
<p>api 19 下 termios.h 文件：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160630174409.jpg" alt="19"></p>
<p>这两个文件确实不一样，于是把19下的该文件复制到 jni 目录，</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160630174555.jpg" alt="jni"></p>
<p>重新编译后，运行，OK，当然设置 <code>compileSdkVersion 19</code> 也是可以的</p>
<p>看了下，该文件从 api 21 就变化了，那么升级 SDK 后，不能高版本编译 so 了吗？</p>
<p>还搜到了 gradle 实验插件：</p>
<p><a href="https://sites.google.com/a/android.com/tools/tech-docs/new-build-system/gradle-experimental#TOC-Standalone-NDK-Plugin" target="_blank" rel="external">Experimental Plugin User Guide</a></p>
<p>玩了下，由于采用的插件较多，各种问题，没成功，有玩过的朋友欢迎指点啊，谢谢！</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！!</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/133812917/m%3D2048/d7dab63e94897ec0ede8d33f5fdbb33f" alt="每日一景"></p>
<p>昨天把串口的驱动代码重新编译下，出现了问题：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java<span class="class">.lang</span><span class="class">.UnsatisfiedLinkError</span>: dlopen failed: cannot locate symbol tcgetattr referenced by libserial_port<span class="class">.so</span>...</span><br></pre></td></tr></table></figure>
<p>一般 jni 开发的话，C 代码命名常出错，检查了下，是 OK 的，然后 google了下，发现基本就下面两个：</p>
<p><a href="http://www.eoeandroid.com/thread-914514-1-1.html">[Android 调试] android串口通信问题，基于android studio</a><br><a href="https://stackoverflow.com/questions/35080172/ndk-unsatisfiedlinkerror-when-lowering-project-api-level-21-to-19/38112597#38112597">NDK UnsatisfiedLinkError when lowering project api level 21 to 19</a></p>
<p>而 stackoverflow 的哥们 rebuild 就好了，我各种折腾也不见好呐，于是看到上一篇 eoe 的，给了我思路：</p>
<p>我们看下包含该函数 <code>**tcgetattr**</code> 的文件， 比较下 NDK api 19 和 23 的 <code>termios.h</code> 文件：</p>
<p>23 的该文件目录：<code>D:\Android\Sdk\ndk-bundle\platforms\android-23\arch-arm\usr\include</code></p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="jni" scheme="http://jp1017.github.io/tags/jni/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Android Studio clean 时产生 Error:Execution failed for task ':app:mockableAndroidJar' > java.lang.NullPointerException (no error message) ]]></title>
    <link href="http://jp1017.github.io/2016/06/22/Android-Studio-clean-%E6%97%B6%E4%BA%A7%E7%94%9F-Error-Execution-failed-for-task-app-mockableAndroidJar%20java.lang.NullPointerException%20(no%20error%20message)/"/>
    <id>http://jp1017.github.io/2016/06/22/Android-Studio-clean-时产生-Error-Execution-failed-for-task-app-mockableAndroidJar java.lang.NullPointerException (no error message)/</id>
    <published>2016-06-22T06:33:48.000Z</published>
    <updated>2016-12-03T05:53:40.421Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/125301449/m%3D2048/ba230b1d36c2b50d2b7af57be81c94e7" alt="每日一景"></p>
<h2 id="20161203更新">20161203更新</h2><p>已经确认这个错误是这个神器的锅: <a href="https://github.com/anggrayudi/android-hidden-api" target="_blank" rel="external">android-hidden-api</a></p>
<p>在Android Studio　2.2.2上使用时，已经没有了上面的试验选项，那么该如何解决呢，在这个issue得到了解决：</p>
<p><a href="https://github.com/anggrayudi/android-hidden-api/issues/21" target="_blank" rel="external">android-hidden-api#21</a></p>
<p><strong>步骤</strong>：</p>
<ol>
<li>Go to File -&gt; Settings -&gt; Build, Execution, Deployment -&gt; Compiler</li>
<li>Add to “Command-line Options”: -x :app:mockableAndroidJar</li>
<li>Press “OK” and try to Rebuild Project again.</li>
</ol>
<p>也是去掉这个task的。</p>
<p>————————————- 我是分割线—————————————-</p>
<p>Android Studio 使用，clean 后 gradle message 出现如下错误：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Error</span>:Execution failed <span class="keyword">for</span> task ':<span class="keyword">app</span>:mockableAndroidJar'.</span><br><span class="line">&gt; java.lang.NullPointerException (<span class="keyword">no</span> <span class="keyword">error</span> message)</span><br></pre></td></tr></table></figure>
<p><img src="‪C:\Users\JP\Desktop\20160627-09-39-53-613_com.eg.android.png" alt="error"></p>
<p>编译能通过，运行也正常，但是强迫症啊，你懂吧 T_T</p>
<a id="more"></a>
<p>这个 Error 指出，<code>task &#39;:app:mockableAndroidJar&#39;</code>运行失败，我们看下 gradle message：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160622145225.jpg" alt="gradle message"></p>
<p>我们可以看到 clean 时有这么些个 task，其中就有我们出错的 <code>:app:mockableAndroidJar</code>，既然出错，那么暂时先关闭这个咯</p>
<p>原来 as 从2.0开始增加了些实验功能，我们可以在 Setting 里找到：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160622145553.jpg" alt="expert"></p>
<p>as 默认最后一项是选中的，我们取消选中就可以了，确定后，我们继续 clean：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160622145807.jpg" alt="clean"></p>
<p>这次 task 里就没有了 <code>&#39;:app:mockableAndroidJar&#39;</code>，当然也就没有错误咯，哈哈。</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/125301449/m%3D2048/ba230b1d36c2b50d2b7af57be81c94e7" alt="每日一景"></p>
<h2 id="20161203更新">20161203更新</h2><p>已经确认这个错误是这个神器的锅: <a href="https://github.com/anggrayudi/android-hidden-api">android-hidden-api</a></p>
<p>在Android Studio　2.2.2上使用时，已经没有了上面的试验选项，那么该如何解决呢，在这个issue得到了解决：</p>
<p><a href="https://github.com/anggrayudi/android-hidden-api/issues/21">android-hidden-api#21</a></p>
<p><strong>步骤</strong>：</p>
<ol>
<li>Go to File -&gt; Settings -&gt; Build, Execution, Deployment -&gt; Compiler</li>
<li>Add to “Command-line Options”: -x :app:mockableAndroidJar</li>
<li>Press “OK” and try to Rebuild Project again.</li>
</ol>
<p>也是去掉这个task的。</p>
<p>————————————- 我是分割线—————————————-</p>
<p>Android Studio 使用，clean 后 gradle message 出现如下错误：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Error</span>:Execution failed <span class="keyword">for</span> task ':<span class="keyword">app</span>:mockableAndroidJar'.</span><br><span class="line">&gt; java.lang.NullPointerException (<span class="keyword">no</span> <span class="keyword">error</span> message)</span><br></pre></td></tr></table></figure>
<p><img src="‪C:\Users\JP\Desktop\20160627-09-39-53-613_com.eg.android.png" alt="error"></p>
<p>编译能通过，运行也正常，但是强迫症啊，你懂吧 T_T</p>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/tags/Android-Studio/"/>
    
      <category term="Android Studio" scheme="http://jp1017.github.io/categories/Android-Studio/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[工作两年的所思所想所感]]></title>
    <link href="http://jp1017.github.io/2016/06/17/%E5%B7%A5%E4%BD%9C%E4%B8%A4%E5%B9%B4%E7%9A%84%E6%89%80%E6%80%9D%E6%89%80%E6%83%B3%E6%89%80%E6%84%9F/"/>
    <id>http://jp1017.github.io/2016/06/17/工作两年的所思所想所感/</id>
    <published>2016-06-17T11:12:54.000Z</published>
    <updated>2016-07-17T08:50:11.030Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/128367049/m%3D2048/22c18e45fdc811068ade2819b6a7316a" alt="每日一景"></p>
<h1 id="写作缘由">写作缘由</h1><hr>
<p>今天早上跑步结束后压腿，发现身体柔韧性严重下降，又想起崂山25公里越野后教练帮我拉伸时说我身体柔韧性不错，然后想了很多，也正好毕业工作两年了，借此总结一下，发现也很久没输出了，是时候了，Ok, Let’s begin。</p>
<a id="more"></a>
<h1 id="我们开始吧">我们开始吧</h1><hr>
<p>总要开始，那就先聊聊这两年自己的收获，不足吧。</p>
<h2 id="工作">工作</h2><p>从开始的小白，慢慢的成长，在所长和经理支持下，稍有起色，从开始的嵌入式 linux C 开发到现在的 Android java，学到了很多，现在的工作进展的很不错。认识了很多朋友，线上的，线下的，他们都很欢乐，对技术有追求，有梦想。</p>
<p>技术上的进步离不开积累和总结，你现在看到的就是我博客的一部分了，这里记录了本人开发中遇到的坑以及一些好玩的有趣的资源，希望有前人栽树，后人乘凉的效果。另外还收集了些 Github 上开源的库，详见文后，以供大家共同学习，进步，学习轮子以便创造新的轮子。</p>
<h2 id="身体">身体</h2><p>“身体是革命的本钱”，这绝不是一句空话。我的工作，每天久坐10H+，不锻炼的话，肯定废。因为久坐伤肾呐，肾乃先天之本，就那些东西，消耗多了肯定虚弱。每个人都想要个好身体，那么问题来了，怎么去拥有呢，很简单，去和身体好的人学习，接触，吸收他们好的东西为我所用。这个道理大家都懂，近朱者赤嘛，孟母三迁只为和好的东西能量共振，问题是，我们要去做，去行动了，否则也就只有想了。</p>
<p>我是一个跑者，而不仅仅是，喜欢登山和跑步，而独爱跑步，下面谈谈个人对跑步的理解：</p>
<ol>
<li>每个人都可以轻松的跑起来，并从中获益，只要跑出去就可以了，just run，如果没动力，不想跑，那还是不要跑了，别太勉强自己，就比如你见到一些知识，看不懂，那就不要懂了，那不是给你看的。</li>
<li>跑步是有技巧的，很多大神跑的又快，又不费力，我朋友圈，悦跑圈每天早上都能看到大神们刷成绩，你也可以，多和他们请教，学习，建议多看看《太极跑》，这本书我推荐了很多次了，我从中收获很多，你开始学习了吗，是时候开始了。 </li>
<li>为什么跑步，对我而言，就是想跑，早起，跑一会，仅此而已，周末适当加量，没错，没有任何目的，just run，跑步这种无聊、孤独的运动，谁逼你都没戏，就得是心中那把火点燃了，自己心甘情愿了，才会坚持下去，而很多东西不是坚持就能一直做下去的，唯真爱不可辜负，去寻找吧。。。</li>
<li>很多妹子担心跑步小腿会粗。。。然而很多妹子都体验到了，他们对这个确实敏感，，问题是这样吗，显然不是，我所认识的很多跑步的妹子，她们的身材都不错，所以，妹子们，继续跑，跑完后记得拉伸，不拉伸小腿真的会粗哦。其实，跑步真正的目的在于跑后，跑后拉伸，身体线条更美；跑后合理饮食，可以增重或减肥等等，我这方面还有待提高。这里给大家拉伸的一些好东西：<a href="https://mp.weixin.qq.com/s?__biz=MzA5NTY2OTUwMw==&amp;mid=209181053&amp;idx=1&amp;sn=1059708ea9bb6f3f243ab41c2da2679f&amp;scene=1&amp;srcid=0910xyk9h6uRHqeA6j6DLJPf#rd" target="_blank" rel="external">跑步后的拉伸运动图解 漫画版</a> </li>
<li>跑步之前最好热身，甚至要活动每一个脚趾头，这样你可以跑的更远，更快，不容易受伤害，来这里吧：<a href="https://mp.weixin.qq.com/s?__biz=MzA5NTY2OTUwMw==&amp;mid=208804772&amp;idx=1&amp;sn=ff0744bbe8e3e5157281f0219d9b5e49&amp;scene=1#rd" target="_blank" rel="external">史上最全跑前拉伸热身方法，另附膝关节损伤预防及恢复措施</a> </li>
<li>对于伤病的理解，我跑步十几年了，伤病基本没有，唯一有印象的是2012年的徒步夜长安活动，当时袜子鞋子穿的不合适，导致最后10公里脚磨出泡，还好最后坚持着走完，而那次活动认识了西安最有名的《漫步人生有情群》，结识了很多热爱生活，酷爱登山的西安友友。原因我总结了，本人体重轻盈，跑姿优雅，怎么做到呢，《太极跑》里去寻找吧，作者可以很轻松的完成超级马拉松，魔鬼马拉松而并不会受伤，所以跟随他的脚步肯定错不了的。 </li>
<li>关于晨跑还是夜跑的问题，这个每个人都有理解。我的建议是晨跑，因为一日之计在于晨，早上阳气出生，所谓动生阳，晨跑可以提高阳气的能量，以满足白天工作生活需要。夜晚，阴气重，你跑步积累阳气，阴阳冲突了，有违自然之道，当时跑就比不跑强，只是夜跑的效果会很差，甚至适得其反。</li>
<li>说说马拉松，半马跑过好多次，PB 150，个人感觉这个就差不多了，中医讲到，最好的运动是走路，心率也就在120左右，太快了真的不好，去搜搜很多跑步运动员的历史就会知道的，这个以后我也得注意，配速不要太快了，515是本人最佳配速，很舒服也不会特别累。第一次全马不会太远，期待。 </li>
</ol>
<p>晒一个今天跑步的图：</p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/2016071605ksc.png" alt="20160716"></p>
<h1 id="其他">其他</h1><p>很惭愧，这两年，除了跑步，登山和工作，其他真没什么好说的了，真要再说的话，就传播下佛法吧。很多人一听到佛法，就开始迷信了，各种排斥。这是很悲剧的事情，为什么会这样呢？教育啊，净空老法师说的好，缺乏圣贤教育。没人教，然后很多人教的都是坏的，这就导致这种悲剧的现象。我之前也是各种排斥，刚强难以调服，后来竟然皈依了三宝而成为正式的佛弟子，就是看了《和谐拯救危机》这个系列片，因缘啊。我去理发，理发师姐姐是三宝弟子，后来知道她的修行很深入，也介绍给了我，提醒我遇到了善知识，今天又去理发，她给我讲了很多她修行的故事，正好还有其他的佛弟子，收获很多，随喜赞叹。她给我介绍的是吉祥祝福法师，法师的弟子来自各行各业，也有博士等高学历人才，网址是这个：</p>
<p><a href="http://buddh.cn/index.html" target="_blank" rel="external"><strong>佛法实践网</strong></a></p>
<p>希望大家有因缘的也去看看，之前朋友圈也分享过</p>
<p><a href="https://pan.baidu.com/s/1pKUfUmZ" target="_blank" rel="external">生子，求子，教子的视频</a></p>
<p>里面主人公也是受该片的影响，在这里至诚感恩净空老法师和陈大惠老师。</p>
<p>今天在湛山寺又遇到善知识，我在里面坐着休息，过来个阿姨，问我是不是居士，然后免费给我结缘了佛法收音机，因缘。你所有接触的人，父母，朋友，老师，上司，都是因缘，无缘不聚呐。回来，我发现里面内容加密了，破解了下，传播到了百度云，大家点这里收听学习：</p>
<p><a href="http://pan.baidu.com/s/1hsz3dZ2" target="_blank" rel="external">http://pan.baidu.com/s/1hsz3dZ2</a></p>
<p>什么是邪教呢，一般会搞个人崇拜，把老大推到神的地位，弟子就跟随他，各种鼓吹，煽动，大家一定要用智慧分辨这些，而对佛法不了解的朋友，学习《和谐拯救危机》，《正信的佛教》。</p>
<p>人类的一个很严重的弱点，就是眼见为实，只要他看到了，才会信。还有就是好的东西很难记住，而差的坏的一学就会并经久不忘，这是很悲剧的事情，那怎么破呢，没办法，这都是因缘，正如前面所说，别勉强，都有因缘，都是业力。如果真想变好，方法也是有的，并且非常简单，而大凡最本质的东西都是最简单的，方法在《了凡四训》里说的很明白的。</p>
<p>你信命吗？命运真的能算出来吗，能改变吗？对于这个问题，每个人都有自己的理解，大多数都不信命，都认为命是自己把握的。那么，你又是怎么把握的呢，对此你满意吗？为什么很多人遇到问题还要去算一算？？？很多老人回头回望一生，大多和早年算的差不多，我外公今年80多，他也告诉我差不多，还有很多东西，这里就不展开了。</p>
<p>原因呢，还是没人教，他不了解啊，所以就各种疑惑，真相在哪里呢，《和谐拯救危机》里讲的很清楚了，世界的本原，世界末日，人类是哪里来的，去哪里，有前生和来世吗？去学习吧，里面可以解决你任何疑惑。命确实是可以算的，很多人不信是因为给他算的这个人的能力有限，算的不好，真正的大师肯定会给你算出来的，一般人的出入都不大，而命运怎么会改变呢，只有大善大恶之人才会改变。而很多算命的都不给佛弟子算，为啥呢，因为佛弟子大多很善，命运大多都改了，所以是算不准的。</p>
<p>前几天，南海事件，有人在群里喊了：“要打仗了，还写毛代码呢”，这是什么，愚痴啊，多么悲哀啊，什么是爱国，个人理解是，不要冲动，看清楚事实，好好工作，好好学习，好好修行，在各自的岗位上做好，善有善报，恶有恶报，不是不报，时间未到。这个是天道，老天都看着呢，都给你记着呢，俗话讲，君子报仇，十年不晚，老天可不止十年，甚至好几世都给你记着呢，美国这个国家早晚的事，亚特兰蒂斯就是他的节奏，早晚的事。而1997年，汤恩比博士和池田大作的谈话里讲到，人类要在21世纪生存下去，要靠大乘佛法和中国儒家教育，这个可以在《展望21世纪》这本书里找到，也可以看《和谐拯救危机》，里面也有讲到的。</p>
<p>毕业两年了，收获非常多，生活还算精彩，有所期待，有所行动，修行继续，任重道远，加油！</p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，我们可以互相探讨，共同进步，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/128367049/m%3D2048/22c18e45fdc811068ade2819b6a7316a" alt="每日一景"></p>
<h1 id="写作缘由">写作缘由</h1><hr>
<p>今天早上跑步结束后压腿，发现身体柔韧性严重下降，又想起崂山25公里越野后教练帮我拉伸时说我身体柔韧性不错，然后想了很多，也正好毕业工作两年了，借此总结一下，发现也很久没输出了，是时候了，Ok, Let’s begin。</p>]]>
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[EventBus3 简单使用及注意点]]></title>
    <link href="http://jp1017.github.io/2016/05/31/EventBus3-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E5%8F%8A%E6%B3%A8%E6%84%8F%E7%82%B9/"/>
    <id>http://jp1017.github.io/2016/05/31/EventBus3-简单使用及注意点/</id>
    <published>2016-05-31T12:18:56.000Z</published>
    <updated>2016-09-07T02:36:08.018Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/123793911/m%3D2048/4e76af7e11bbf3693469c952f0fc21d4" alt="每日一景"></p>
<h1 id="EventBus3_简介">EventBus3 简介</h1><hr>
<p>EventBus Android 发布/订阅事件总线，可简化 Activities, Fragments, Threads, Services 等组件间的消息传递，可替代 Intent, Handler, BroadCast ，接口等传统方案，更快，代码更小，50K 左右的 jar 包，代码更优雅，彻底解耦。EventBus3 是最新版本，官网地址：</p>
<p><a href="https://github.com/greenrobot/EventBus" target="_blank" rel="external">https://github.com/greenrobot/EventBus</a></p>
<a id="more"></a>
<h1 id="使用">使用</h1><hr>
<p>这里简单介绍下使用方法：</p>
<p>1 添加依赖 <code>compile &#39;org.greenrobot:eventbus:3.0.0&#39;</code></p>
<p>2 编写事件类</p>
<p>3 post 发布事件</p>
<p>这里有直接发布和滞留发布</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//直接发布</span></span><br><span class="line">EventBus.getDefault().<span class="keyword">post</span>(<span class="string">"直接发布"</span>);</span><br><span class="line"><span class="comment">//滞留发布</span></span><br><span class="line">EventBus.getDefault().postSticky(<span class="string">"滞留发布"</span>);</span><br></pre></td></tr></table></figure>
<p>注意可以发布的是一个 <code>Object</code> 类，发送什么，订阅者就会接收什么。</p>
<p>此处要注意两个地方：</p>
<ul>
<li><p>如果 post 字节数据，此时订阅者的方法里参数需为 Byte，而不是 byte，同样的，post int数据，订阅方法参数需为 Interger，其他基本数据类型同理 </p>
</li>
<li><p>如果 post 字符串，那么所有方法的参数是 String 类型的订阅者都会接收到事件而执行方法。 </p>
</li>
</ul>
<p>4 订阅者接收事件</p>
<p>订阅的时候要注册和取消注册。</p>
<p><strong>注册</strong>一般是在 <code>onCreate</code> 和 <code>onStart</code> 里注册，尽量不要在 <code>onResume</code>，可能出现多次注册的情况，比如下面这个异常：：</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBusException: Subscriber <span class="keyword">class</span> already registered <span class="keyword">to</span> <span class="keyword">event</span> <span class="keyword">class</span></span><br></pre></td></tr></table></figure>
<p>可以先判断下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!EventBus.getDefault().isRegistered(<span class="keyword">this</span>)) &#123;</span><br><span class="line">    EventBus.getDefault().<span class="keyword">register</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参看这里：<a href="https://stackoverflow.com/questions/30135367/greenrobot-eventbusexception-subscriber-class-already-registered-to-event-class" target="_blank" rel="external">GreenRobot EventBusException: Subscriber class already registered to event class</a></p>
<p><strong>取消注册</strong> 要写到 <code>onDestroy</code> 方法里，不要写到 <code>onStop</code> 里，有时会出现异常的哦</p>
<p>EventBus 3 和之前版本的 EventBus 不兼容，这里采用注解的方法来接收事件，四种注解 <code>@Subscrible</code> 、<code>@Subscrible(threadMode = ThreadMode.ASYNC)</code>、<code>@Subscribe(threadMode = ThreadMode.BACKGROUND)</code>、<code>@Subscribe(threadMode = ThreadMode.MAIN)</code> 分别对应之前的 <code>onEvent()</code>、<code>onEventAsync()</code>、<code>onEventBackground()</code>、<code>onEventMainThread()</code>。</p>
<p>EventBus 3 采用注解后，方法名没有限制了，参数只有一个，和发送者 post 的参数对应配对，在未声明 threadMode 时，默认的线程模式为 ThreadMode.POSTING，只有在该模式下才可以取消线程，否则容易导致如下异常:</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.greenrobot.eventbus.<span class="type">EventBusException</span>: <span class="type">This</span> <span class="keyword">method</span> may only be called <span class="keyword">from</span> inside event handling methods on the posting thread</span><br></pre></td></tr></table></figure>
<p>由于可在任何地方都可以 post 一个事件，那么在不同线程之间传递事件，比如在工作线程传递一个事件更新UI线程中的一个控件，则需要注意 threadMode 的切换。</p>
<p>好了，基本使用大概就这些，后面遇到会补充…</p>
<p>2016.07.13补充：</p>
<p>今天遇到了订阅事件无法执行的情况，分析后发现是订阅事件的 <code>Activity</code> 还未执行的原因。</p>
<p>找到原因就好办了，这时候就需要用到 <code>postSticky</code>。</p>
<p>发布事件时用 <code>postSticky</code> 操作：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">EventBus</span><span class="class">.getDefault</span>()<span class="class">.postSticky</span>(<span class="tag">event</span>);</span><br></pre></td></tr></table></figure>
<p>订阅时，添加 <code>sticky = true</code></p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Subscribe(sticky = <span class="literal">true</span>)    //看下 <span class="escape">`@</span>Subscribe<span class="escape">` </span>源码知道 <span class="escape">`s</span>ticky<span class="escape">` </span>默认是 <span class="escape">`f</span>alse<span class="escape">`</span><br><span class="line"></span>public void onEvent(Event e) &#123; </span><br><span class="line">    ---</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里也有个坑，就是 <code>EventBus.getDefault().register(this);</code> 注册时最好放到各变量初始化最后，否则可能会出现一些变量空指针异常。</p>
<p>同时要注意，取消注册后就收不到了，这就是有些情况你会发现莫名其妙的收不到订阅的原因。</p>
<h1 id="混淆">混淆</h1><hr>
<p>没什么说的，复制下面代码到你的混淆文件即可：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-keepattributes *<span class="constant">Annotation</span>*</span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> ** &#123;    </span></span><br><span class="line">    <span class="variable">@org</span>.greenrobot.eventbus.<span class="constant">Subscribe</span> &lt;methods&gt;;</span><br><span class="line">&#125;</span><br><span class="line">-keep <span class="class"><span class="keyword">enum</span> <span class="title">org</span>.<span class="title">greenrobot</span>.<span class="title">eventbus</span>.<span class="title">ThreadMode</span> &#123; </span></span><br><span class="line">      *; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Only required if you use AsyncExecutor</span></span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> * <span class="title">extends</span> <span class="title">org</span>.<span class="title">greenrobot</span>.<span class="title">eventbus</span>.<span class="title">util</span>.<span class="title">ThrowableFailureEvent</span> &#123;    </span></span><br><span class="line">    &lt;init&gt;(java.lang.<span class="constant">Throwable</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2016-09-06 更新as可用插件：</p>
<p>发布的事件多了以后，我们很难去管理，下面推荐个 AS 插件：</p>
<p><a href="https://github.com/likfe/eventbus3-intellij-plugin" target="_blank" rel="external">https://github.com/likfe/eventbus3-intellij-plugin</a></p>
<p><img src="https://raw.githubusercontent.com/kgmyshin/eventbus3-intellij-plugin/master/art/cap.gif" width="600"></p>
<p>更多 AS 插件请访问：<a href="https://github.com/jp1017/AndroidStudioPlugins" target="_blank" rel="external">https://github.com/jp1017/AndroidStudioPlugins</a></p>
<p>欲知更多 EventBus 的内容，还可参考：</p>
<p><a href="http://mrljdx.com/2016/03/18/EventBus3%E6%96%B0%E7%89%B9%E6%80%A7%E5%8F%8A%E7%94%A8%E6%B3%95/" target="_blank" rel="external">EventBus3新特性及用法</a><br><a href="http://a.codekk.com/detail/Android/Trinea/EventBus%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90" target="_blank" rel="external">EventBus 源码解析</a><br><a href="http://blog.csdn.net/lmj623565791/article/details/40920453" target="_blank" rel="external">Android EventBus源码解析 带你深入理解EventBus</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/123793911/m%3D2048/4e76af7e11bbf3693469c952f0fc21d4" alt="每日一景"></p>
<h1 id="EventBus3_简介">EventBus3 简介</h1><hr>
<p>EventBus Android 发布/订阅事件总线，可简化 Activities, Fragments, Threads, Services 等组件间的消息传递，可替代 Intent, Handler, BroadCast ，接口等传统方案，更快，代码更小，50K 左右的 jar 包，代码更优雅，彻底解耦。EventBus3 是最新版本，官网地址：</p>
<p><a href="https://github.com/greenrobot/EventBus">https://github.com/greenrobot/EventBus</a></p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="EventBus3" scheme="http://jp1017.github.io/tags/EventBus3/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[安卓定位及坐标转换]]></title>
    <link href="http://jp1017.github.io/2016/05/23/%E5%AE%89%E5%8D%93%E5%AE%9A%E4%BD%8D%E5%8F%8A%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2/"/>
    <id>http://jp1017.github.io/2016/05/23/安卓定位及坐标转换/</id>
    <published>2016-05-23T03:53:07.000Z</published>
    <updated>2016-05-23T12:01:47.076Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/52296484/m%3D2048/9a5810ef6b98956873f114635371e9c3" alt="每日一景"></p>
<h2 id="定位">定位</h2><hr>
<p>需要添加位置权限，这里有两个：</p>
<ul>
<li>android.permission.ACCESS_COARSE_LOCATION – 允许 API 利用 WiFi 或移动蜂窝数据（或同时利用两者）来确定设备位置。API 返回的位置精确度大约相当于城市街区。</li>
<li>android.permission.ACCESS_FINE_LOCATION – 允许 API 利用包括全球定位系统 (GPS) 在内的可用位置提供商以及 WiFi 和移动蜂窝数据尽可能精确地确定位置。</li>
</ul>
<p>下面介绍几种获取的方法：</p>
<p><strong>1  安卓 SDK android.location.LocationManager</strong></p>
<p>单独获取位置信息还是很简单的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">LocationManager mManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);</span><br><span class="line"><span class="keyword">if</span> (ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_FINE_LOCATION)</span><br><span class="line">        != PackageManager.PERMISSION_GRANTED</span><br><span class="line">        &amp;&amp; ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_COARSE_LOCATION)</span><br><span class="line">        != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">Location mLocation = mManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);<span class="comment">//需要权限检测，上面添加</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> mLat = location.getLatitude();<span class="comment">//获取纬度</span></span><br><span class="line"><span class="keyword">double</span> mLng = location.getLongitude();<span class="comment">//获取经度</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>实际开发中，我们需要实时定位，就需要监听位置变化来实现，</p>
<p>声明 LocationListener，然后调用 requestLocationUpdates 方法即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 获取原生gps信息，代码放 MainActivity 里就可以</span><br><span class="line"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getGPSInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    LocationManager mManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);</span><br><span class="line">    <span class="keyword">if</span> (ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_FINE_LOCATION)</span><br><span class="line">            != PackageManager.PERMISSION_GRANTED</span><br><span class="line">            &amp;&amp; ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_COARSE_LOCATION)</span><br><span class="line">            != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Location mLocation = mManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);</span><br><span class="line"></span><br><span class="line">    updateGPSInfo(mLocation);</span><br><span class="line"></span><br><span class="line">    mManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class="number">2000</span>, <span class="number">8</span>, <span class="keyword">new</span> LocationListener() &#123;</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLocationChanged</span><span class="params">(Location location)</span> </span>&#123;</span><br><span class="line">            updateGPSInfo(mLocation);<span class="comment">//位置变化时，更新位置信息</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStatusChanged</span><span class="params">(String provider, <span class="keyword">int</span> status, Bundle extras)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProviderEnabled</span><span class="params">(String provider)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// 当GPS LocationProvider可用时，更新位置</span></span><br><span class="line">            <span class="keyword">if</span> (ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_FINE_LOCATION)</span><br><span class="line">                    != PackageManager.PERMISSION_GRANTED</span><br><span class="line">                    &amp;&amp; ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_COARSE_LOCATION)</span><br><span class="line">                    != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            updateGPSInfo(mManager.getLastKnownLocation(provider));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProviderDisabled</span><span class="params">(String provider)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 更新经纬度信息</span><br><span class="line"> * <span class="doctag">@param</span> location</span><br><span class="line"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateGPSInfo</span><span class="params">(Location location)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (location != <span class="keyword">null</span>) &#123;</span><br><span class="line">       mLat = location.getLatitude();</span><br><span class="line">       mLng = location.getLongitude();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码放到了这个 Gist: <a href="https://gist.github.com/jp1017/dc87d742ae5d1edf9fad0b43223f74bb" target="_blank" rel="external">https://gist.github.com/jp1017/dc87d742ae5d1edf9fad0b43223f74bb</a></p>
<p>说明一点：requestLocationUpdates 方法有多个重载方法：</p>
<p>常用的是下面这个：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestLocationUpdates</span> <span class="params">(String provider, <span class="keyword">long</span> minTime, <span class="keyword">float</span> minDistance, LocationListener listener)</span></span></span><br></pre></td></tr></table></figure>
<p>当时间超过 minTime（单位：毫秒），或者位置移动超过 minDistance（单位：米），就会调用 listener 中的方法更新 GPS 信息。<br>如果要尽可能实时的更新 GPS 信息，请将 minTime 和 minDistance 都设置成0。</p>
<p>官方文档: <a href="https://developer.android.com/reference/android/location/LocationManager.html" target="_blank" rel="external">https://developer.android.com/reference/android/location/LocationManager.html</a></p>
<p><strong>2 google 地图 api</strong></p>
<p>参考这里，很详细了：<a href="https://developers.google.com/maps/documentation/android-api/location?hl=zh-cn#_2" target="_blank" rel="external">https://developers.google.com/maps/documentation/android-api/location?hl=zh-cn#_2</a></p>
<p><strong>3 高德地图 api</strong></p>
<p>参考高德地图 定位api ：<a href="http://lbs.amap.com/api/android-location-sdk/locationsummary/" target="_blank" rel="external">http://lbs.amap.com/api/android-location-sdk/locationsummary/</a></p>
<p><strong>4 百度地图 api</strong></p>
<p>参考百度地图api：<a href="http://lbsyun.baidu.com/index.php?title=android-locsdk/guide/getloc" target="_blank" rel="external">http://lbsyun.baidu.com/index.php?title=android-locsdk/guide/getloc</a></p>
<h2 id="坐标转换">坐标转换</h2><hr>
<p>安卓系统常用的 GPS 坐标有下面几种：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>别名</th>
<th>标准</th>
<th>获取方式</th>
<th>应用场合</th>
</tr>
</thead>
<tbody>
<tr>
<td>wgs84</td>
<td>地球坐标</td>
<td>国际标准</td>
<td>从 GPS 设备中获取的坐标数据</td>
<td>国际地图提供商，谷歌国际地图</td>
</tr>
<tr>
<td>gcj02</td>
<td>火星坐标，国测局坐标</td>
<td>中国标准</td>
<td>从国行移动设备中定位获取的坐标数据</td>
<td>高德地图，谷歌地图，腾讯地图，阿里云地图</td>
</tr>
<tr>
<td>bd09</td>
<td>百度坐标</td>
<td>百度标准</td>
<td>百度在火星坐标上二次加密后的坐标数据</td>
<td>百度地图</td>
</tr>
</tbody>
</table>
<p><strong>1 gcj02 转成 bd09</strong></p>
<p>可以使用百度地图 SDK 里的工具类 CoordinateConverter</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/<span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"> <span class="keyword">*</span> gcj02 坐标转换成百度坐标</span><br><span class="line"> <span class="keyword">*</span></span><br><span class="line"> <span class="keyword">*</span> <span class="comment">@param srLatLng 要转换的 gcj02 经纬度</span></span><br><span class="line"> <span class="keyword">*</span> <span class="comment">@return 转换后的百度经纬度</span></span><br><span class="line"> <span class="keyword">*</span>/</span><br><span class="line">public LatLng convertGPSToBaidu(LatLng srLatLng) &#123;</span><br><span class="line">    CoordinateConverter converter = new CoordinateConverter();</span><br><span class="line">    converter.from(CoordinateConverter.CoordType.COMMON);</span><br><span class="line">    converter.coord(srLatLng);</span><br><span class="line">    return converter.convert();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外一个是刚从 gayhub 上找到的：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 火星坐标系(GCJ-02)转百度坐标系(BD-09)</span><br><span class="line"> * </span><br><span class="line"> * 谷歌、高德——&gt;百度</span><br><span class="line"> * @param lng 火星坐标经度</span><br><span class="line"> * @param lat 火星坐标纬度</span><br><span class="line"> * @return 百度坐标数组</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span>[] gcj02tobd09(<span class="keyword">double</span> lng, <span class="keyword">double</span> lat) &#123;</span><br><span class="line">	<span class="keyword">double</span> z = Math.<span class="built_in">sqrt</span>(lng * lng + lat * lat) + <span class="number">0.00002</span> * Math.<span class="built_in">sin</span>(lat * x_pi);</span><br><span class="line">	<span class="keyword">double</span> theta = Math.<span class="built_in">atan2</span>(lat, lng) + <span class="number">0.000003</span> * Math.<span class="built_in">cos</span>(lng * x_pi);</span><br><span class="line">	<span class="keyword">double</span> bd_lng = z * Math.<span class="built_in">cos</span>(theta) + <span class="number">0.0065</span>;</span><br><span class="line">	<span class="keyword">double</span> bd_lat = z * Math.<span class="built_in">sin</span>(theta) + <span class="number">0.006</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">double</span>[] &#123; bd_lng, bd_lat &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>2 bd09 转成 gcj02</strong></p>
<p>万能的 gayhub 拯救了我们：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 百度坐标系(BD-09)转火星坐标系(GCJ-02)</span><br><span class="line"> * </span><br><span class="line"> * 百度——&gt;谷歌、高德</span><br><span class="line"> * @param bd_lon 百度坐标纬度</span><br><span class="line"> * @param bd_lat 百度坐标经度</span><br><span class="line"> * @return 火星坐标数组</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span>[] bd09togcj02(<span class="keyword">double</span> bd_lon, <span class="keyword">double</span> bd_lat) &#123;</span><br><span class="line">	<span class="keyword">double</span> x = bd_lon - <span class="number">0.0065</span>;</span><br><span class="line">	<span class="keyword">double</span> y = bd_lat - <span class="number">0.006</span>;</span><br><span class="line">	<span class="keyword">double</span> z = Math.<span class="built_in">sqrt</span>(x * x + y * y) - <span class="number">0.00002</span> * Math.<span class="built_in">sin</span>(y * x_pi);</span><br><span class="line">	<span class="keyword">double</span> theta = Math.<span class="built_in">atan2</span>(y, x) - <span class="number">0.000003</span> * Math.<span class="built_in">cos</span>(x * x_pi);</span><br><span class="line">	<span class="keyword">double</span> gg_lng = z * Math.<span class="built_in">cos</span>(theta);</span><br><span class="line">	<span class="keyword">double</span> gg_lat = z * Math.<span class="built_in">sin</span>(theta);</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">double</span>[] &#123; gg_lng, gg_lat &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外，高德地图也提供了 api ：<a href="http://lbsbbs.amap.com/forum.php?mod=viewthread&amp;tid=724&amp;highlight=%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2" target="_blank" rel="external">如何将非高德坐标转换为高德坐标系</a></p>
<p><strong>3 wgs84 转成 gcj02</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * WGS84转GCJ02(火星坐标系)</span><br><span class="line"> * </span><br><span class="line"> * @param lng WGS84坐标系的经度</span><br><span class="line"> * @param lat WGS84坐标系的纬度</span><br><span class="line"> * @return 火星坐标数组</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span>[] wgs84togcj02(<span class="keyword">double</span> lng, <span class="keyword">double</span> lat) &#123;</span><br><span class="line">	<span class="keyword">if</span> (out_of_china(lng, lat)) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">double</span>[] &#123; lng, lat &#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">double</span> dlat = transformlat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">	<span class="keyword">double</span> dlng = transformlng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">	<span class="keyword">double</span> radlat = lat / <span class="number">180.0</span> * pi;</span><br><span class="line">	<span class="keyword">double</span> magic = Math.<span class="built_in">sin</span>(radlat);</span><br><span class="line">	magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line">	<span class="keyword">double</span> sqrtmagic = Math.<span class="built_in">sqrt</span>(magic);</span><br><span class="line">	dlat = (dlat * <span class="number">180.0</span>) / ((a * (<span class="number">1</span> - ee)) / (magic * sqrtmagic) * pi);</span><br><span class="line">	dlng = (dlng * <span class="number">180.0</span>) / (a / sqrtmagic * Math.<span class="built_in">cos</span>(radlat) * pi);</span><br><span class="line">	<span class="keyword">double</span> mglat = lat + dlat;</span><br><span class="line">	<span class="keyword">double</span> mglng = lng + dlng;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">double</span>[] &#123; mglng, mglat &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，这个也可以利用上面的高德的 api</p>
<p><strong>4 gcj02 转成 wgs84</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * GCJ02(火星坐标系)转GPS84</span><br><span class="line"> * </span><br><span class="line"> * @param lng 火星坐标系的经度</span><br><span class="line"> * @param lat 火星坐标系纬度</span><br><span class="line"> * @return WGS84坐标数组</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span>[] gcj02towgs84(<span class="keyword">double</span> lng, <span class="keyword">double</span> lat) &#123;</span><br><span class="line">	<span class="keyword">if</span> (out_of_china(lng, lat)) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">double</span>[] &#123; lng, lat &#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">double</span> dlat = transformlat(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">	<span class="keyword">double</span> dlng = transformlng(lng - <span class="number">105.0</span>, lat - <span class="number">35.0</span>);</span><br><span class="line">	<span class="keyword">double</span> radlat = lat / <span class="number">180.0</span> * pi;</span><br><span class="line">	<span class="keyword">double</span> magic = Math.<span class="built_in">sin</span>(radlat);</span><br><span class="line">	magic = <span class="number">1</span> - ee * magic * magic;</span><br><span class="line">	<span class="keyword">double</span> sqrtmagic = Math.<span class="built_in">sqrt</span>(magic);</span><br><span class="line">	dlat = (dlat * <span class="number">180.0</span>) / ((a * (<span class="number">1</span> - ee)) / (magic * sqrtmagic) * pi);</span><br><span class="line">	dlng = (dlng * <span class="number">180.0</span>) / (a / sqrtmagic * Math.<span class="built_in">cos</span>(radlat) * pi);</span><br><span class="line">	<span class="keyword">double</span> mglat = lat + dlat;</span><br><span class="line">	<span class="keyword">double</span> mglng = lng + dlng;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">double</span>[] &#123; lng * <span class="number">2</span> - mglng, lat * <span class="number">2</span> - mglat &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>5 wgs84 转成 bd09</strong></p>
<p>这个没有直接转的，需要 gcj02 做媒介</p>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * WGS坐标转百度坐标系(BD-09)</span><br><span class="line"> * </span><br><span class="line"> * <span class="doctag">@param</span> lng WGS84坐标系的经度</span><br><span class="line"> * <span class="doctag">@param</span> lat WGS84坐标系的纬度</span><br><span class="line"> * <span class="doctag">@return</span> 百度坐标数组</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span>[] wgs84tobd09(<span class="keyword">double</span> lng, <span class="keyword">double</span> lat) &#123;</span><br><span class="line">	<span class="keyword">double</span>[] gcj = wgs84togcj02(lng, lat);</span><br><span class="line">	<span class="keyword">double</span>[] bd09 = gcj02tobd09(gcj[<span class="number">0</span>], gcj[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> bd09;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>6 bd09 转成 wgs84</strong></p>
<p>同上，需要媒介 gcj02</p>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * 百度坐标系(BD-09)转WGS坐标</span><br><span class="line"> * </span><br><span class="line"> * <span class="doctag">@param</span> lng 百度坐标纬度</span><br><span class="line"> * <span class="doctag">@param</span> lat 百度坐标经度</span><br><span class="line"> * <span class="doctag">@return</span> WGS84坐标数组</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span>[] bd09towgs84(<span class="keyword">double</span> lng, <span class="keyword">double</span> lat) &#123;</span><br><span class="line">	<span class="keyword">double</span>[] gcj = bd09togcj02(lng, lat);</span><br><span class="line">	<span class="keyword">double</span>[] wgs84 = gcj02towgs84(gcj[<span class="number">0</span>], gcj[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> wgs84;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好了，就是这样子了，部分细节请来 gayhub：</p>
<p><a href="https://github.com/geosmart/coordtransform/blob/master/src/main/java/me/demo/util/geo/CoordinateTransformUtil.java" target="_blank" rel="external">coordtransform</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="https://drscdn.500px.org/photo/52296484/m%3D2048/9a5810ef6b98956873f114635371e9c3" alt="每日一景"></p>
<h2 id="定位">定位</h2><hr>
<p>需要添加位置权限，这里有两个：</p>
<ul>
<li>android.permission.ACCESS_COARSE_LOCATION – 允许 API 利用 WiFi 或移动蜂窝数据（或同时利用两者）来确定设备位置。API 返回的位置精确度大约相当于城市街区。</li>
<li>android.permission.ACCESS_FINE_LOCATION – 允许 API 利用包括全球定位系统 (GPS) 在内的可用位置提供商以及 WiFi 和移动蜂窝数据尽可能精确地确定位置。</li>
</ul>
<p>下面介绍几种获取的方法：</p>
<p><strong>1  安卓 SDK android.location.LocationManager</strong></p>
<p>单独获取位置信息还是很简单的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">LocationManager mManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);</span><br><span class="line"><span class="keyword">if</span> (ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_FINE_LOCATION)</span><br><span class="line">        != PackageManager.PERMISSION_GRANTED</span><br><span class="line">        &amp;&amp; ActivityCompat.checkSelfPermission(<span class="keyword">this</span>, Manifest.permission.ACCESS_COARSE_LOCATION)</span><br><span class="line">        != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">Location mLocation = mManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);<span class="comment">//需要权限检测，上面添加</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> mLat = location.getLatitude();<span class="comment">//获取纬度</span></span><br><span class="line"><span class="keyword">double</span> mLng = location.getLongitude();<span class="comment">//获取经度</span></span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="Android" scheme="http://jp1017.github.io/tags/Android/"/>
    
      <category term="定位" scheme="http://jp1017.github.io/tags/%E5%AE%9A%E4%BD%8D/"/>
    
      <category term="Android" scheme="http://jp1017.github.io/categories/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ubuntu 下常用软件及主题推荐]]></title>
    <link href="http://jp1017.github.io/2016/04/25/ubuntu-%E4%B8%8B%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%8F%8A%E4%B8%BB%E9%A2%98%E6%8E%A8%E8%8D%90/"/>
    <id>http://jp1017.github.io/2016/04/25/ubuntu-下常用软件及主题推荐/</id>
    <published>2016-04-25T06:18:08.000Z</published>
    <updated>2016-10-14T12:27:14.482Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916" target="_blank" rel="external">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/QQ%E6%88%AA%E5%9B%BE20160425080309.jpg" alt="每日一景"></p>
<h1 id="常用软件">常用软件</h1><hr>
<p>大部分软件都可在软件中心找到，16.04叫 Ubuntu Software</p>
<ol>
<li>新立得软件包管理器 synaptic</li>
<li>vlc 多媒体播放程序</li>
<li>GParted 分区编辑器</li>
<li>ubuntu 额外的版权受限程序</li>
<li>聊天 qq</li>
</ol>
<a id="more"></a>
<ol>
<li><p>编译器 codeblocks</p>
</li>
<li><p>stardict 星际译王，要下字库的哦</p>
</li>
<li>阿贴便签 tomboy</li>
<li><p>sougou输入法，wps，qq</p>
</li>
<li><p>classicmenu indicator (经典菜单指示器）</p>
</li>
<li><p>gbrainy 游戏，智力的</p>
</li>
<li><p>system load indicator 系统监视器</p>
</li>
<li>下载工具 uget</li>
<li>unity tweak tool unity 桌面环境的前端配置工具</li>
<li><p>dia，专业的流程图工具</p>
</li>
<li><p>chm 查看器 kchmviewer</p>
</li>
<li>温度监控 Psensor</li>
<li>清理工具 BleachBit</li>
<li>shadowsocks-qt5, 配置服务器类型为socket v5</li>
</ol>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo<span class="instruction"> add-apt-repository </span>ppa:hzwhuang/ss-qt5</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install shadowsocks-qt5</span><br></pre></td></tr></table></figure>
<h1 id="主题">主题</h1><hr>
<p><a href="http://www.sysgeek.cn/additional-icon-packs-linux/" target="_blank" rel="external">适用于Linux的5款最佳桌面图标集</a><br><a href="http://gnome-look.org/content/show.php/Uranus?content=174476" target="_blank" rel="external">ubuntu 主题大全</a></p>
<p>最后，非常感谢您的阅读，有任何疑问，可以后面评论，谢谢！</p>
<p>神奇的安卓开发网站：<a href="http://androidcat.com/" target="_blank" rel="external">http://androidcat.com/</a></p>
<p>安卓开源库收集整理：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>掘金：    <a href="http://gold.xitu.io/user/5675e9d560b2f42a127e4916">jp1017</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/QQ%E6%88%AA%E5%9B%BE20160425080309.jpg" alt="每日一景"></p>
<h1 id="常用软件">常用软件</h1><hr>
<p>大部分软件都可在软件中心找到，16.04叫 Ubuntu Software</p>
<ol>
<li>新立得软件包管理器 synaptic</li>
<li>vlc 多媒体播放程序</li>
<li>GParted 分区编辑器</li>
<li>ubuntu 额外的版权受限程序</li>
<li>聊天 qq</li>
</ol>]]>
    
    </summary>
    
      <category term="ubuntu" scheme="http://jp1017.github.io/tags/ubuntu/"/>
    
      <category term="ubuntu" scheme="http://jp1017.github.io/categories/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[java 基本数据类型及数组使用集锦]]></title>
    <link href="http://jp1017.github.io/2016/04/13/java-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%8F%8A%E6%95%B0%E7%BB%84%E4%BD%BF%E7%94%A8%E9%9B%86%E5%90%88/"/>
    <id>http://jp1017.github.io/2016/04/13/java-基本数据类型及数组使用集合/</id>
    <published>2016-04-13T02:12:34.000Z</published>
    <updated>2016-06-07T06:16:08.358Z</updated>
    <content type="html"><![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6" target="_blank" rel="external">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406" target="_blank" rel="external">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles" target="_blank" rel="external">追风917</a></p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160419103518.jpg" alt="每日一景"></p>
<h1 id="Arrays-copyOf与System-arrayCopy">Arrays.copyOf与System.arrayCopy</h1><hr>
<p>数组拷贝，有Arrays.copyOf与System.arrayCopy，区别是System.arraycopy要求你必须提供一个目标数组，而Arrays.copyOf不用你提提供目标数组，其内部实现就是用的 System.arrayCopy</p>
<p>另外，这个Arrays类有很多实用方法，比如Arrays.toString(int[] ints),可以直接把数组转成字符串，参数是8种基本数据类型数组和Object数组</p>
<h1 id="自动装箱和拆箱">自动装箱和拆箱</h1><hr>
<p>jdk1.5 新增加的技能，自动装箱允许我们将基本类型和装箱基本类型(Boxed Primitive Type)混用,按需自动装箱和拆箱</p>
<p>它们之间性能是有明显的差别的(基本类型更优)，所以优先使用基本数据类型——<a href="http://www.jianshu.com/p/5298828dd34e" target="_blank" rel="external">第2章-创建和销毁对象</a></p>
<a id="more"></a>
<h1 id="volatile不能保证原子性而Atomic可以">volatile不能保证原子性而Atomic可以</h1><hr>
<p>volatile告诉jvm， 它所修饰的变量不保留拷贝，直接访问主内存中的（也就是上面说的A) ，但是不能用其来进行多线程同步控制</p>
<p>AtomicInteger 是用原子方式更新的int值。主要用于在高并发环境下的高效程序处理。使用非阻塞算法来实现并发控制。</p>
<p><a href="http://www.jianshu.com/p/e4670e9cfce9" target="_blank" rel="external">Java多线程深度探索</a><br><a href="http://www.cnblogs.com/Mainz/p/3556430.html" target="_blank" rel="external">为什么volatile不能保证原子性而Atomic可以？</a></p>
<h1 id="字节数组和ascii字符串的转换">字节数组和ascii字符串的转换</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * ascii字符串转成字节数组: "123" --&gt; &#123;0x31, 0x32, 0x33&#125;</span><br><span class="line"> * <span class="doctag">@param</span> str</span><br><span class="line"> * <span class="doctag">@return</span></span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] getBytes(String str) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> str.getBytes(<span class="string">"US-ASCII"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 字节数组转成 ascii 字符串: &#123;0x31, 0x32, 0x33&#125; --&gt; "123"</span><br><span class="line"> * <span class="doctag">@param</span> aBuf</span><br><span class="line"> * <span class="doctag">@return</span></span><br><span class="line"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getString</span><span class="params">(<span class="keyword">byte</span>[] aBuf)</span> </span>&#123;</span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">char</span>[] chars = <span class="keyword">new</span> <span class="keyword">char</span>[aBuf.length];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars.length; i++) &#123;</span><br><span class="line">        chars[i] = (<span class="keyword">char</span>) aBuf[i];</span><br><span class="line">    &#125;</span><br><span class="line">    sb.append(chars);</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="byte_数据和二进制字符串的转换">byte 数据和二进制字符串的转换</h1><p>需求是这样的，有个字节数据 0x23(16进制)， 获取该数据的每一位的值，也就是转化为二进制的字符串</p>
<p>我们都知道，java虚拟机中，byte 占 8 位数据， 0x23 也就是相当于二进制的数据 0010 0011</p>
<p>那么如何输出这个数据呢，方法有这么几种：</p>
<ol>
<li><p>Integer.toBinaryString()<br>这个可以直接转化为二进制数据，但是前面是去除0的，也就是会输出：10 0011</p>
</li>
<li><p>转化为字节数组，用 byte 保存每一位数据 </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> byte[] byteToByteArray(byte b) &#123;</span><br><span class="line">    byte[] <span class="built_in">array</span> = <span class="keyword">new</span> byte[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">7</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="built_in">array</span>[i] = (byte) (b &amp; <span class="number">1</span>);</span><br><span class="line">        b = (byte) (b &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">array</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>移位运算 </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span><br><span class="line"> * 把byte转为字符串的bit </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">byteToBit</span><span class="params">(byte b)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>  </span><br><span class="line">            + (byte) ((b &gt;&gt; <span class="number">7</span>) &amp; <span class="number">0x1</span>) + (byte) ((b &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x1</span>)  </span><br><span class="line">            + (byte) ((b &gt;&gt; <span class="number">5</span>) &amp; <span class="number">0x1</span>) + (byte) ((b &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x1</span>)  </span><br><span class="line">            + (byte) ((b &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x1</span>) + (byte) ((b &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x1</span>)  </span><br><span class="line">            + (byte) ((b &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x1</span>) + (byte) ((b &gt;&gt; <span class="number">0</span>) &amp; <span class="number">0x1</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>二进制字符串转化为字节数据</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> byte <span class="title">binaryStringToByte</span><span class="params">(String byteStr)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> re, len;  </span><br><span class="line">    <span class="keyword">if</span> (null == byteStr) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    len = byteStr.length();  </span><br><span class="line">    <span class="keyword">if</span> (len != <span class="number">4</span> &amp;&amp; len != <span class="number">8</span>) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> (len == <span class="number">8</span>) &#123;<span class="comment">// 8 bit处理  </span></span><br><span class="line">        <span class="keyword">if</span> (byteStr.charAt(<span class="number">0</span>) == <span class="string">'0'</span>) &#123;<span class="comment">// 正数  </span></span><br><span class="line">            re = Integer.parseInt(byteStr, <span class="number">2</span>);  </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="comment">// 负数  </span></span><br><span class="line">            re = Integer.parseInt(byteStr, <span class="number">2</span>) - <span class="number">256</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;<span class="comment">// 4 bit处理  </span></span><br><span class="line">        re = Integer.parseInt(byteStr, <span class="number">2</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> (byte) re;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>安卓开源库收集整理中，欢迎 PR， star，地址：<a href="https://github.com/XXApple/AndroidLibs" target="_blank" rel="external">https://github.com/XXApple/AndroidLibs</a></p>
<p>分享是一种美德，更是一种生活方式！！</p>
<blockquote>
<p>也许你会说我是一个梦想者，但我不是唯一的一个。</p>
<p>悦分享，越快乐^_^</p>
</blockquote>
<p>欢迎交流，转载请注明出处，谢谢！</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>博客：    <a href="http://jp1017.github.io/">安卓之家</a><br>微博：    <a href="http://weibo.com/1321395433/profile?topnav=1&amp;wvr=6">追风917</a><br>CSDN：    <a href="http://blog.csdn.net/u010331406">蒋朋的家</a><br>简书：    <a href="http://www.jianshu.com/users/8cb49b5ad78b/latest_articles">追风917</a></p>
<p><img src="http://7xlah4.com1.z0.glb.clouddn.com/20160419103518.jpg" alt="每日一景"></p>
<h1 id="Arrays-copyOf与System-arrayCopy">Arrays.copyOf与System.arrayCopy</h1><hr>
<p>数组拷贝，有Arrays.copyOf与System.arrayCopy，区别是System.arraycopy要求你必须提供一个目标数组，而Arrays.copyOf不用你提提供目标数组，其内部实现就是用的 System.arrayCopy</p>
<p>另外，这个Arrays类有很多实用方法，比如Arrays.toString(int[] ints),可以直接把数组转成字符串，参数是8种基本数据类型数组和Object数组</p>
<h1 id="自动装箱和拆箱">自动装箱和拆箱</h1><hr>
<p>jdk1.5 新增加的技能，自动装箱允许我们将基本类型和装箱基本类型(Boxed Primitive Type)混用,按需自动装箱和拆箱</p>
<p>它们之间性能是有明显的差别的(基本类型更优)，所以优先使用基本数据类型——<a href="http://www.jianshu.com/p/5298828dd34e">第2章-创建和销毁对象</a></p>]]>
    
    </summary>
    
  </entry>
  
</feed>
